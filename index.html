<!DOCTYPE html>
<html lang="es"><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>PLATAFORMA DE PROCESOS</title>
<style>
  :root{
    --bg:#f3f4f6;
    --surface:#ffffff;
    --ink:#0b1120;
    --muted:#667085;
    --soft:#eceff3;
    --shadow:0 8px 20px rgba(0,0,0,.1);
    --ring:0 0 0 2px rgba(248,113,113,.2);
    --grad:linear-gradient(90deg,#111827 0%,#4b5563 40%,#111827 100%);
    --pillGrad:linear-gradient(180deg,#ffffff 0%,#f2f4f8 100%);
    --accent:#ef4444;
    --accent-dark:#b91c1c;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;
    background:var(--bg);
    color:var(--ink);
    font:14px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif;
  }

  /* ===== Top bar ===== */
  .topbar{
    position:sticky;
    top:0;
    z-index:30;
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    gap:.6rem;
    padding:.55rem .9rem .7rem;
    background:var(--grad);
    color:#f9fafb;
    box-shadow:0 8px 20px rgba(0,0,0,.45);
    border-bottom:1px solid rgba(15,23,42,.8);
  }
  .title{
    display:flex;
    align-items:center;
    gap:.35rem;
    font-weight:900;
    font-size:22px;
    flex:0 0 auto;
    letter-spacing:.03em;
    text-shadow:0 1px 2px rgba(0,0,0,.6);
  }
  .title .ear{
    font-size:28px;
    line-height:1;
    display:inline-block;
    transform:translateY(2px);
    filter:drop-shadow(0 2px 2px rgba(0,0,0,.6));
  }

  /* ===== BOTONES ROJOS (alineados, pequeÃ±os, ancho auto) ===== */
  .btn3d{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap:.2rem;
    padding:.12rem .5rem;
    border:0;
    border-radius:9999px;
    color:#f9fafb;
    background:linear-gradient(180deg,var(--accent) 0%,var(--accent-dark) 100%);
    box-shadow:
      inset 0 1px 0 rgba(255,255,255,.25),
      0 3px 0 rgba(0,0,0,.65),
      0 11px 20px rgba(0,0,0,.6);
    cursor:pointer;
    font-weight:700;
    font-size:10px;        /* letra mÃ¡s pequeÃ±a */
    line-height:1;
    height:24px;           /* todos misma altura */
    white-space:nowrap;    /* no se parten en dos lÃ­neas */
  }
  .btn3d:active{
    transform:translateY(1px);
    box-shadow:
      inset 0 1px 0 rgba(255,255,255,.18),
      0 2px 0 rgba(0,0,0,.6),
      0 8px 16px rgba(0,0,0,.6);
  }

  .bar-right{
    margin-left:auto;
    display:flex;
    align-items:center;
    gap:.25rem;
    flex-wrap:nowrap;  /* todos los rojos de la derecha en una lÃ­nea */
  }

  .topbar > .btn3d{
    flex:0 0 auto;     /* los tres de la izquierda tambiÃ©n en la misma fila */
  }

  .stamp{
    color:#f9fafb;
    opacity:.9;
    font-size:11px;         /* un poco mÃ¡s pequeÃ±o para que quepa todo */
    background:rgba(15,23,42,.8);
    border-radius:9999px;
    padding:.2rem .6rem;
    box-shadow:0 2px 8px rgba(0,0,0,.5);
    white-space:nowrap;
  }
  .bar-right .btn3d svg{width:14px;height:14px}
  .search{
    flex:1 1 100%;
    display:flex;
    align-items:center;
    background:rgba(15,23,42,.55);
    padding:.35rem .75rem;
    border-radius:9999px;
    margin-top:.3rem;
    box-shadow:inset 0 1px 0 rgba(255,255,255,.08);
  }
  .search input{
    width:100%;
    border:0;
    background:transparent;
    outline:0;
    color:#e5e7eb;
    font-weight:600;
    font-size:13px;
  }
  .search input::placeholder{color:rgba(209,213,219,.82);}

  /* ===== Dept selector ===== */
  .dept-block{
    display:flex;
    align-items:center;
    gap:.25rem;
  }
  .dept-select{
    border-radius:9999px;
    border:1px solid #e5e7eb;
    padding:.2rem .6rem;
    font-size:12px;
    min-width:150px;
    background:#f9fafb;
    box-shadow:inset 0 1px 0 #fff;
    color:#111827;
  }

  /* ===== Layout ===== */
  .wrap{
    display:grid;
    grid-template-columns:280px minmax(0,1fr);
    gap:0;
    padding:0 0 10px 0;
    min-height:calc(100dvh - 60px);
    width:100%;
  }
  .left,.right{
    background:var(--surface);
  }
  .left{
    padding:8px 6px 8px 8px;
    border-right:1px solid #e5e7eb;
    box-shadow:var(--shadow);
    border-radius:0;
    display:flex;
    flex-direction:column;
  }
  .right{
    padding:10px;
    display:flex;
    flex-direction:column;
    gap:10px;
    position:relative;
    border-radius:0;
    box-shadow:var(--shadow);
  }
  #deptInfo{margin-bottom:4px;}
  #processList{flex:1 1 auto;}
  @media (max-width:1020px){
    .wrap{
      grid-template-columns:1fr;
    }
    .left{
      border-right:0;
      border-bottom:1px solid #e5e7eb;
    }
  }

  /* ===== Lista de procesos ===== */
  .proc-item{
    display:flex;
    flex-direction:column;
    gap:.4rem;
    background:var(--pillGrad);
    border-radius:14px;
    padding:.5rem .7rem;
    margin:.35rem 0;
    box-shadow:inset 0 1px 0 #fff,0 1px 0 rgba(0,0,0,.06);
    border:2px solid transparent;
  }
  .proc-item.activo{
    border-color:rgba(248,113,113,.4);
    box-shadow:var(--ring),0 1px 0 rgba(0,0,0,.06);
  }
  .proc-row{display:flex;align-items:center;gap:.45rem;cursor:pointer}
  .dot{
    width:10px;
    height:10px;
    border-radius:50%;
    background:#ddd;
    box-shadow:inset 0 0 0 2px rgba(0,0,0,.08);
  }
  .proc-name{flex:1;font-weight:800;font-size:14px}
  .proc-acts{display:flex;align-items:center;gap:.3rem}
  .icon-btn{
    width:26px;
    height:26px;
    border-radius:11px;
    border:0;
    background:#f2f4f8;
    box-shadow:inset 0 1px 0 #fff,0 3px 0 rgba(0,0,0,.13);
    cursor:pointer;
    font-size:13px;
  }
  .icon-btn:active{transform:translateY(1px)}
  .proc-detail{display:none}
  .proc-detail textarea{
    width:100%;
    min-height:64px;
    border-radius:10px;
    border:1px solid #e6e8ec;
    padding:.45rem;
    background:#fff;
    font-size:12px;
  }

  /* ===== Dept info caja izquierda ===== */
  .dept-info-box{
    padding:4px;
    border-radius:14px;
    background:linear-gradient(135deg,#020617 0%,#1f2937 50%,#020617 100%);
    border:1px solid #020617;
    box-shadow:0 4px 10px rgba(0,0,0,.55);
    font-size:12px;
    color:#e5e7eb;
  }
  .dept-info-header{
    display:flex;
    align-items:center;
    gap:.45rem;
    padding:.45rem .7rem;
  }
  .dept-info-title{
    font-weight:800;
    font-size:13px;
    color:#f9fafb;
  }
  .dept-info-box .dot{
    box-shadow:inset 0 0 0 2px rgba(15,23,42,.9);
  }
  .dept-info-box .proc-acts{
    margin-left:auto;
    display:flex;
    align-items:center;
    gap:.3rem;
  }
  .dept-desc{
    padding:0 .45rem .55rem .45rem;
  }
  .dept-desc textarea{
    width:100%;
    min-height:52px;
    margin-top:4px;
    border-radius:8px;
    border:1px solid #e5e7eb;
    padding:4px;
    font-size:12px;
    background:#ffffff;
    color:#111827;
  }
/* ===== Subproceso ===== */
  .module{
    position:relative;
    background:var(--pillGrad);
    border-radius:14px;
    box-shadow:inset 0 1px 0 #fff,0 1px 0 rgba(0,0,0,.06);
    display:flex;
    flex-direction:column;
    gap:6px;
    padding:8px;
    margin-bottom:10px;
  }
  .module.module-subchild{
    margin-left:46px;
    max-width:calc(100% - 60px);
    border:1px dashed rgba(148,163,184,.85);
    box-shadow:0 4px 12px rgba(15,23,42,.12);
    padding:6px 6px 8px;
    position:relative;
  }
  .module.module-subchild::before{
    content:"";
    position:absolute;
    left:42px;
    top:-22px;
    height:22px;
    border-left:1.5px dashed rgba(148,163,184,.9);
  }
  .module.module-subchild::after{
    content:"";
    position:absolute;
    left:0;
    top:-22px;
    width:42px;
    border-top:1.5px dashed rgba(148,163,184,.9);
  }
  .module-subchild .mod-head{
    margin:2px 22px 4px 22px;
  }

  .mod-head{
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    gap:.4rem;
    background:linear-gradient(135deg,#020617 0%,#1f2937 50%,#020617 100%);
    color:#e5e7eb;
    border-radius:12px;
    padding:.4rem .7rem;
    box-shadow:0 4px 10px rgba(0,0,0,.45);
    border-left:4px solid var(--proc,#ef4444);
  }
  .mod-title{
    flex:1;
    font-weight:900;
    border:0;
    background:transparent;
    color:#f9fafb;
    outline:0;
    font-size:14px;
  }
  body.pa-locked input.mod-title,
  body.pa-locked input.mod-title[readonly]{
    opacity:1 !important;
    filter:none !important;
    background:transparent !important;
    color:#f9fafb !important;
  }
  body.pa-locked .role-input,
  body.pa-locked .role-input[readonly]{
    background:transparent !important;
  }


  .mod-title::placeholder{color:#9ca3af}
  .sel{
    border:1px solid #4b5563;
    background:#0f172a;
    color:#e5e7eb;
    border-radius:10px;
    padding:.25rem .45rem;
    font-size:12px;
    box-shadow:0 1px 0 rgba(255,255,255,.1);
  }
  .resp-extra{
    border:1px solid #4b5563;
    background:#020617;
    color:#e5e7eb;
    border-radius:9999px;
    padding:.2rem .5rem;
    font-size:11px;
    min-width:110px;
    box-shadow:0 1px 0 rgba(255,255,255,.12);
  }
  .role-desc{
    padding:.25rem .8rem;
    border-radius:9999px;
    border:1px solid #4b5563;
    background:#020617;
    color:#e5e7eb;
    font-size:11px;
    max-width:520px;
    display:flex;
    align-items:flex-start;
    flex-wrap:wrap;
    gap:.25rem .5rem;
    white-space:normal;
  }
  .role-desc .role-input{
    background:transparent;
    border:0;
    outline:none;
    color:inherit;
    font-size:inherit;
    padding:0 .25rem;
    min-width:80px;
  }
  .role-desc .role-hint{
    flex-basis:100%;
    font-size:11px;
    opacity:.9;
    margin-top:2px;
  }


  .role-desc strong{
    font-weight:600;
  }

  .pill{
    height:30px;
    padding:0 .7rem;
    background:#111827;
    border-radius:9999px;
    color:#f9fafb;
    border:0;
    cursor:pointer;
    box-shadow:
      inset 0 1px 0 rgba(255,255,255,.06),
      0 3px 0 rgba(0,0,0,.7),
      0 10px 18px rgba(0,0,0,.75);
    font-size:12px;
    font-weight:700;
  }
  .pill:active{transform:translateY(1px)}
  .badge-diana{margin-left:.2rem;}

  .mod-detail{display:none}
  .mod-detail textarea{
    width:100%;
    min-height:50px;
    border:1px solid #e6e8ec;
    border-radius:10px;
    padding:.45rem;
    background:#fff;
    font-size:12px;
  }

  /* ===== Pasos ===== */
  .steps{
    position:relative;
    z-index:0;
    display:block;
    padding:8px 4px 18px;
    width:100%;
  }
  .steps > div{
    display:flex;
    flex-direction:column;
    align-items:flex-start;
    gap:4px;
  }

  .step{
    position:relative;
    z-index:2;
    display:flex;
    flex-direction:column;
    align-items:flex-start;
    background:#ffffff;
    border-radius:13px;
    padding:7px 10px 9px 14px;
    box-shadow:
      inset 0 1px 0 #fff,
      0 3px 0 rgba(15,23,42,.24),
      0 8px 16px rgba(15,23,42,.16);
    width:290px;
    min-height:58px;
    border:1px solid rgba(148,163,184,.7);
  }
  .step.sub-step{
    margin-top:6px;
    margin-left:24px;
    border-style:dashed;
    background:#f9fafb;
  }
  .sub-step .bubble{
    border-radius:999px;
    min-width:0;
    width:auto;
    padding:2px 10px;
    height:auto;
    display:inline-flex;
    align-items:center;
    justify-content:center;
    font-size:11px;
  }


  .step::before{
    content:"";
    position:absolute;
    left:0;
    top:0;
    bottom:0;
    width:7px;
    border-radius:13px 0 0 13px;
    background:var(--proc,#e5e7eb);
    opacity:0.95;
  }

  .bubble{
    min-width:22px;
    height:22px;
    border-radius:9999px;
    background:linear-gradient(180deg,var(--proc,#2563eb) 0%,#1d4ed8 100%);
    color:#fff;
    display:grid;
    place-items:center;
    font-weight:900;
    font-size:11px;
    margin-bottom:3px;
    box-shadow:
      inset 0 1px 0 rgba(255,255,255,.6),
      0 2px 0 rgba(15,23,42,.35),
      0 4px 7px rgba(15,23,42,.35);
    padding:0 2px;
    z-index:1;
  }
  .step.selected{
    box-shadow:
      0 0 0 2px rgba(37,99,235,.3),
      0 3px 0 rgba(15,23,42,.3),
      0 10px 20px rgba(15,23,42,.24);
  }
  .step .title{
    font-weight:800;
    border:0;
    background:transparent;
    outline:0;
    width:100%;
    margin-top:1px;
    font-size:13.5px;
    resize:none;
    overflow:hidden;
    line-height:1.3;
    white-space:pre-wrap;
    word-break:break-word;
  }
  .step-mainline,
  .sub-headline{
    display:flex;
    align-items:center;
    gap:.45rem;
    width:100%;
  }
  .step-mainline .title,
  .sub-headline .title{
    flex:1;
    margin-top:0;
  }
  .sub-step .step-detail{
    margin-left:0;
    width:100%;
  }

  .minis{
    display:flex;
    gap:.25rem;
    margin-top:5px;
    margin-left:auto;
  }
  .mini{
    width:24px;
    height:24px;
    border-radius:8px;
    border:0;
    background:#f2f4f8;
    cursor:pointer;
    box-shadow:inset 0 1px 0 #fff,0 3px 0 rgba(0,0,0,.2);
    font-size:13px;
  }
  .mini-attach{
    background:#ef4444;
    color:#fff;
    font-size:18px; /* mano protagonista */
    display:flex;
    align-items:center;
    justify-content:space-between;
    padding:0 4px;
    width:38px;  /* mÃ¡s ancha para que mano y nÃºmero respiren dentro del rojo */
  }
  .mini-attach:hover{
    background:#dc2626;
  }
  .mini-attach .mini-count{
    font-size:9px;       /* muy pequeÃ±o */
    font-weight:900;
    color:#111827;
    line-height:1;
    margin-left:2px;     /* para que no toque la mano */
  }

  .mini:active{transform:translateY(1px)}
  .step-attachments{
    margin-top:4px;
    font-size:11px;
    color:#4b5563;
    display:flex;
    flex-direction:column;
    gap:2px;
  }
  .attach-chip{
    display:inline-flex;
    align-items:center;
    gap:4px;
    margin-left:4px;
  }
  .mini-attach-del{
    padding:0 6px;
    font-size:10px;
  }

  .step-links,
  .step-docs{
    display:flex;
    flex-wrap:wrap;
    gap:4px 6px;
    align-items:center;
  }
  .step-links .label,
  .step-docs .label{
    font-weight:600;
  }
  .step-links a,
  .step-docs a{
    text-decoration:underline;
    cursor:pointer;
  }


  .step.is-meta-step::after{
    content:"ğŸ¯ META";
    position:absolute;
    top:4px;
    right:6px;
    font-size:11px;
    font-weight:800;
    color:#0f172a;
    padding:2px 7px;
    border-radius:999px;
    background:rgba(255,255,255,.97);
    box-shadow:0 2px 4px rgba(15,23,42,.25);
  }

  .step-menu{
    position:absolute;
    right:6px;
    bottom:32px;
    background:#020617;
    border-radius:10px;
    padding:4px 5px;
    display:flex;
    flex-wrap:wrap;
    gap:3px;
    box-shadow:0 7px 18px rgba(15,23,42,.75);
    z-index:5;
  }
  .step-menu button{
    width:24px;
    height:24px;
    border-radius:7px;
    border:0;
    background:#111827;
    color:#e5e7eb;
    font-size:13px;
    cursor:pointer;
    box-shadow:inset 0 1px 0 rgba(255,255,255,.1),0 3px 0 rgba(0,0,0,.7);
  }
  .step-menu button:active{transform:translateY(1px)}

  .step-detail{
    margin:4px 0 0 26px;
    width:calc(100% - 26px);
  }
  .step-detail textarea{
    width:100%;
    min-height:46px;
    border-radius:9px;
    border:1px solid #e6e8ec;
    padding:.35rem .45rem;
    font-size:12px;
    background:#fff;
    resize:vertical;
  }

  .step-extra{
    position:relative;
    margin-top:6px;
    margin-left:0;
    padding:0;
    border:none;
    background:transparent;
    width:auto;
    max-width:none;
  }
  .step-extra::before{
    content:"";
    position:absolute;
    left:36px;
    top:-8px;
    bottom:-8px;
    border-left:2px dashed rgba(148,163,184,.9);
    z-index:1;
  }

  .step-extra textarea{
    width:100%;
    border:0;
    outline:none;
    background:transparent;
    resize:none;
    overflow:hidden;
    font-size:11.5px;
    line-height:1.3;
    white-space:pre-wrap;
  }

  .flow-svg{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    pointer-events:none;
    overflow:visible;
    z-index:0;
  }

  .chip{
    display:inline-flex;
    align-items:center;
    gap:.3rem;
    font-weight:800;
    border-radius:9999px;
    padding:.18rem .5rem;
    color:#111;
    font-size:11px;
  }

  /* ===== SÃ / NO ===== */
  .branches{
    margin:6px 0 0 18px;
    padding:5px 7px;
    border-radius:10px;
    border:1px dashed rgba(148,163,184,.85);
    background:rgba(248,250,252,.96);
    box-shadow:0 1px 4px rgba(15,23,42,.08);
    position:relative;
    z-index:3;
    max-width:100%;
    font-size:11px;
  }
  .branches::before{
    content:"";
    position:absolute;
    top:-8px;
    left:28px;
    width:0;
    height:8px;
    border-left:1px dashed rgba(148,163,184,.85);
  }
  .branches-inner{
    display:flex;
    flex-wrap:wrap;
    gap:5px;
    align-items:flex-start;
  }
  .branch{
    background:#fff;
    border-radius:8px;
    padding:.35rem .4rem .4rem;
    box-shadow:inset 0 1px 0 #fff;
    flex:1 1 48%;
    max-width:calc(50% - 4px);
    min-width:220px;
    position:relative;
  }
  .branch.branch-has-content{
    border:1px solid rgba(248,113,113,.6);
  }
  .branch.yes .bh-label{font-size:11px;font-weight:700;opacity:.85;text-transform:uppercase;}
  .branch.no .bh-label{font-size:12px;font-weight:900;text-transform:uppercase;}
  .branch.branch-has-content .bh-label{
    color:#b91c1c;
  }
  .bh-top{
    display:flex;
    align-items:center;
    gap:.25rem;
    margin-bottom:.25rem;
    flex-wrap:wrap;
  }
  .bh-top-right{
    margin-left:auto;
    display:flex;
    align-items:center;
    gap:.18rem;
  }
  .plist{
    display:flex;
    flex-direction:column;
    gap:.22rem;
  }
  .point{
    display:flex;
    align-items:center;
    gap:.25rem;
    flex-wrap:wrap;
  }
  .point .num{
    min-width:30px;
    font-weight:900;
    opacity:.6;
    font-size:10px;
  }
  .pt-input{
    flex:1 1 260px;
    border:1px solid #e6e8ec;
    border-radius:7px;
    padding:.18rem .35rem;
    min-width:150px;
    font-size:11px;
  }
  .p-actions{
    display:flex;
    align-items:center;
    gap:.12rem;
  }
  .p-mini{
    width:22px;
    height:22px;
    border-radius:7px;
    border:0;
    background:#f2f4f8;
    cursor:pointer;
    box-shadow:inset 0 1px 0 #fff,0 2px 0 rgba(0,0,0,.1);
    font-size:11px;
  }
  .p-mini:active{transform:translateY(1px)}
  .p-toggle{
    background:#e5e7eb;
    font-weight:900;
  }
  .p-extra{
    display:flex;
    gap:.16rem;
  }
  .children{
    margin-left:30px;
    display:flex;
    flex-direction:column;
    gap:.16rem;
  }

  .branch-indicator{
    margin:6px 0 0 46px;
    font-size:11px;
    color:#374151;
    cursor:pointer;
    display:inline-flex;
    align-items:center;
    gap:4px;
    background:#e5e7eb;
    padding:2px 9px;
    border-radius:999px;
    border:1px solid #d1d5db;
    box-shadow:0 1px 3px rgba(148,163,184,.7);
    z-index:4;
  }
  .branch-indicator:hover{
    background:#d1d5db;
    color:#111827;
  }

  .branch-collapse{
    margin:3px 0 4px auto;
    font-size:10px;
    color:#374151;
    cursor:pointer;
    background:#e5e7eb;
    padding:1px 8px;
    border-radius:999px;
    display:inline-flex;
    align-items:center;
    gap:4px;
    border:1px solid #d1d5db;
  }
  .branch-collapse:hover{
    background:#d1d5db;
    color:#111827;
  }

  .hide{display:none!important}

  .pa-toast{
    position:fixed;
    right:12px;
    bottom:14px;
    background:#111;
    color:#fff;
    padding:.5rem .7rem;
    border-radius:9px;
    box-shadow:0 6px 18px rgba(0,0,0,.2);
    opacity:0;
    transform:translateY(6px);
    transition:all .2s;
    z-index:99999;
    font:13px system-ui;
  }
  .pa-toast.show{opacity:1;transform:translateY(0)}

  
  body.pa-locked .mini[data-act="step-extra"],
  body.pa-locked .mini[data-act="step-del"],
  body.pa-locked .mini[data-act="menu-toggle"],
  body.pa-locked .mini[data-act="sub-delete"],
  body.pa-locked button[data-act="add-step"],
  body.pa-locked button[data-act="add-submodule"],
  body.pa-locked button[data-act="close"],
  body.pa-locked button[data-act="menu-delete"],
  body.pa-locked button[data-act="menu-link"],
  body.pa-locked button[data-act="menu-doc"],
  body.pa-locked button[data-act="menu-flag"],
  body.pa-locked button[data-act="attach-del"],
  body.pa-locked #btnAddProcess,
  body.pa-locked #btnAddStepGlobal,
  body.pa-locked #btnAddSubprocPaso,
  body.pa-locked #btnDeptAdd,
  body.pa-locked .proc-item .icon-btn[title="Renombrar"],
  body.pa-locked .proc-item .icon-btn[title="Eliminar"]{
    display:none !important;
  }
@media print{
    .pa-tools-hide,
    .topbar,
    .left,
    .search{
      display:none!important;
    }
    body{
      background:#fff;
    }
    .wrap{
      grid-template-columns:1fr;
      padding:0;
    }
    .right{
      box-shadow:none;
      border-radius:0;
      padding:0;
    }
    .module{
      page-break-inside:avoid;
      margin-bottom:10mm;
    }
  }

  body.pa-locked .is-readonly{opacity:.6;filter:saturate(.6)}
  body.pa-locked .lock-block{ pointer-events:none !important; opacity:.6; }
  body.pa-locked input[readonly],
  body.pa-locked textarea[readonly]{background:#f7f7f7}
</style>
</head>
<body class="">
  <div class="topbar">
    <div class="title">PLATAFORMA DE PROCESOS</div>

    <button id="btnAddProcess" class="btn3d">+ Procesos</button>
    <button id="btnAddSubprocPaso" class="btn3d">+ Subproceso + Paso</button>
    <button id="btnAddStepGlobal" class="btn3d" title="AÃ±adir paso al subproceso abierto">+ Paso</button>

    <div class="bar-right">
      <button id="paPinBtn" class="btn3d pa-tools-hide locked" title="PIN (AR4321)">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M17 8V7a5 5 0 10-10 0v1M6 8h12v12H6V8z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
        PIN
      </button>
      <button id="paPdfBtn" class="btn3d pa-tools-hide" title="Imprimir / Guardar PDF">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M6 9V4h12v5M6 18h12M6 14h12" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
        PDF
      </button>
      <button id="paHtmlBtn" class="btn3d pa-tools-hide" title="Descargar HTML idÃ©ntico">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 3v12m0 0l-4-4m4 4l4-4M4 21h16" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
        HTML
      </button>
      <button id="paSaveCloud" class="btn3d pa-tools-hide" title="Guardar copia en nube (local)">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M7 18a4 4 0 110-8 5 5 0 119.9 1H18a3 3 0 110 6H7z" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path></svg>
        Nube
      </button>

      <div class="dept-block">
        <button id="btnDeptAdd" class="btn3d" title="AÃ±adir departamento">Departamentos+</button>
        <select id="deptSelect" class="dept-select"><option value="plgt0900">AUDIO</option></select>
      </div>

      <span id="stamp" class="stamp">Ãšltima actualizaciÃ³n 20/11/2025, 04:59:56</span>
      <button id="btnSave" class="btn3d">ğŸ’¾ Guardar</button>
    </div>

    <div class="search"><input id="q" placeholder="Buscarâ€¦"></div>
  </div>

  <div class="wrap">
    <div class="left">
      <div id="deptInfo"><div class="dept-info-box"><div class="dept-info-header"><span class="dot" style="background:#bdbdbd"></span>
    <span class="dept-info-title">Departamento: AUDIO</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div></div><div class="dept-desc hide" aria-hidden="true" style="display: none;"><textarea></textarea></div></div></div>
      <div id="processList"><div class="proc-item" data-pid="pvnfkpn8"><div class="proc-row"><span class="dot" style="background:#bde0fe"></span>
    <span class="proc-name">Nuevo proceso</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div></div><div class="proc-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del procesoâ€¦"></textarea></div></div><div class="proc-item" data-pid="p92lfzvx"><div class="proc-row"><span class="dot" style="background:#caffbf"></span>
    <span class="proc-name">Nuevo proceso</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div></div><div class="proc-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del procesoâ€¦"></textarea></div></div><div class="proc-item" data-pid="prb7yd58"><div class="proc-row"><span class="dot" style="background:#ffadad"></span>
    <span class="proc-name">Nuevo proceso</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div></div><div class="proc-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del procesoâ€¦"></textarea></div></div><div class="proc-item" data-pid="pqc0pkx0"><div class="proc-row"><span class="dot" style="background:#fdffb6"></span>
    <span class="proc-name">Nuevo proceso</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div></div><div class="proc-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del procesoâ€¦"></textarea></div></div><div class="proc-item" data-pid="ptabg9bj"><div class="proc-row"><span class="dot" style="background:#bdb2ff"></span>
    <span class="proc-name">Nuevo proceso</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div></div><div class="proc-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del procesoâ€¦"></textarea></div></div><div class="proc-item" data-pid="pauwompt"><div class="proc-row"><span class="dot" style="background:#bdb2ff"></span>
    <span class="proc-name">Nuevo proceso</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div></div><div class="proc-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del procesoâ€¦"></textarea></div></div><div class="proc-item" data-pid="pl2wz4vz"><div class="proc-row"><span class="dot" style="background:#ffc6ff"></span>
    <span class="proc-name">Nuevo proceso</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div></div><div class="proc-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del procesoâ€¦"></textarea></div></div><div class="proc-item" data-pid="p5f60ohf"><div class="proc-row"><span class="dot" style="background:#a0e7e5"></span>
    <span class="proc-name">Nuevo proceso</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div></div><div class="proc-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del procesoâ€¦"></textarea></div></div><div class="proc-item" data-pid="phip02e7"><div class="proc-row"><span class="dot" style="background:#c7f9cc"></span>
    <span class="proc-name">Nuevo proceso</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div></div><div class="proc-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del procesoâ€¦"></textarea></div></div></div>
    </div>
    <div class="right" id="modules"><div class="module" data-mid="pq1ynmh3" data-pid="pvnfkpn8" style="--proc: #bde0fe;"><div class="mod-head" style="--proc: #bde0fe;"><input class="mod-title" value="Nuevo proceso - Pasos" title="Nuevo proceso - Pasos">
    <select class="sel"><option selected="">AudiÃ³logo</option><option>Responsable</option><option>Otros</option></select>
    <input class="resp-extra" placeholder="Nombre otrosâ€¦" value="" style="display:none">
    <button class="pill" data-act="toggle-detail" aria-expanded="false">â–¾ Detalle</button>
    <button class="pill" data-act="toggle-steps" aria-expanded="true">â–¾ Pasos</button>
    <button class="pill" data-act="add-submodule">+ Sub/subproceso</button>
    <button class="pill" data-act="add-step">+ Paso</button>
    <button class="pill" data-act="close">ğŸ¯ Guardar</button>
    <button class="pill" data-act="del">â€“</button></div><div class="mod-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="DescripciÃ³n del subprocesoâ€¦" title=""></textarea></div><div class="steps" aria-hidden="false" style="--proc: #bde0fe; display: block; height: 530px;"><div style="position: absolute; left: 10px; top: 0px;"><div class="step" data-row="0" data-row-dir="1" style="--proc: #bde0fe;">
    <div class="bubble">1</div>
    <textarea class="title" rows="1" title="Nuevo paso" style="height: 24px;"></textarea>
    <div class="minis">
      <button class="mini" data-act="menu-toggle" title="Opciones de paso">âœï¸</button>
    </div><div class="step-menu hide">
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-branches" title="SÃ / NO">â“</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc" title="Adjuntar documento">ğŸ“</button>
  </div></div><div class="step-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del pasoâ€¦" title=""></textarea></div></div><div style="position: absolute; left: 329.5px; top: 0px;"><div class="step" data-row="0" data-row-dir="1" style="--proc: #bde0fe;">
    <div class="bubble">2</div>
    <textarea class="title" rows="1" title="Nuevo paso" style="height: 24px;"></textarea>
    <div class="minis">
      <button class="mini" data-act="menu-toggle" title="Opciones de paso">âœï¸</button>
    </div><div class="step-menu hide">
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-branches" title="SÃ / NO">â“</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc" title="Adjuntar documento">ğŸ“</button>
  </div></div><div class="step-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del pasoâ€¦" title=""></textarea></div></div><div style="position: absolute; left: 649px; top: 0px;"><div class="step" data-row="0" data-row-dir="1" style="--proc: #bde0fe;">
    <div class="bubble">3</div>
    <textarea class="title" rows="1" title="Nuevo paso" style="height: 24px;"></textarea>
    <div class="minis">
      <button class="mini" data-act="menu-toggle" title="Opciones de paso">âœï¸</button>
    </div><div class="step-menu hide">
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-branches" title="SÃ / NO">â“</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc" title="Adjuntar documento">ğŸ“</button>
  </div></div><div class="step-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del pasoâ€¦" title=""></textarea></div></div><div style="position: absolute; left: 649px; top: 128px;"><div class="step" data-row="1" data-row-dir="-1" style="--proc: #bde0fe;">
    <div class="bubble">4</div>
    <textarea class="title" rows="1" title="Nuevo paso" style="height: 24px;"></textarea>
    <div class="minis">
      <button class="mini" data-act="menu-toggle" title="Opciones de paso">âœï¸</button>
    </div><div class="step-menu hide">
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-branches" title="SÃ / NO">â“</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc" title="Adjuntar documento">ğŸ“</button>
  </div></div><div class="step-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del pasoâ€¦" title=""></textarea></div></div><div style="position: absolute; left: 329.5px; top: 128px;"><div class="step" data-row="1" data-row-dir="-1" style="--proc: #bde0fe;">
    <div class="bubble">5</div>
    <textarea class="title" rows="1" title="Nuevo paso" style="height: 24px;"></textarea>
    <div class="minis">
      <button class="mini" data-act="menu-toggle" title="Opciones de paso">âœï¸</button>
    </div><div class="step-menu hide">
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-branches" title="SÃ / NO">â“</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc" title="Adjuntar documento">ğŸ“</button>
  </div></div><div class="step-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del pasoâ€¦" title=""></textarea></div></div><div style="position: absolute; left: 10px; top: 128px;"><div class="step" data-row="1" data-row-dir="-1" style="--proc: #bde0fe;">
    <div class="bubble">6</div>
    <textarea class="title" rows="1" title="Nuevo paso" style="height: 24px;"></textarea>
    <div class="minis">
      <button class="mini" data-act="menu-toggle" title="Opciones de paso">âœï¸</button>
    </div><div class="step-menu hide">
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-branches" title="SÃ / NO">â“</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc" title="Adjuntar documento">ğŸ“</button>
  </div></div><div class="step-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del pasoâ€¦" title=""></textarea></div></div><div style="position: absolute; left: 10px; top: 256px;"><div class="step" data-row="2" data-row-dir="1" style="--proc: #bde0fe;">
    <div class="bubble">7</div>
    <textarea class="title" rows="1" title="Nuevo paso" style="height: 24px;"></textarea>
    <div class="minis">
      <button class="mini" data-act="menu-toggle" title="Opciones de paso (enlaces: 0, docs: 1)">âœï¸</button>
    </div><div class="step-menu hide">
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-branches" title="SÃ / NO">â“</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc" title="Adjuntar documento">ğŸ“</button>
  </div></div><div class="step-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del pasoâ€¦" title=""></textarea><div class="step-attachments"><div class="step-docs"><span class="label">Docs:</span><a href="data:application/vnd.openxmlformats-officedocument.wordprocessingml.document;base64,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" download="ANAMNES HACE-MOTIVO DE VISITA.docx">ANAMNES HACE-MOTIVO DE VISITA.docx</a></div></div></div></div><div style="position: absolute; left: 329.5px; top: 256px;"><div class="step" data-row="2" data-row-dir="1" style="--proc: #bde0fe;">
    <div class="bubble">8</div>
    <textarea class="title" rows="1" title="Nuevo paso" style="height: 24px;"></textarea>
    <div class="minis">
      <button class="mini" data-act="menu-toggle" title="Opciones de paso">âœï¸</button>
    </div><div class="step-menu hide">
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-branches" title="SÃ / NO">â“</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc" title="Adjuntar documento">ğŸ“</button>
  </div></div><div class="step-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del pasoâ€¦" title=""></textarea></div></div><div style="position: absolute; left: 649px; top: 256px;"><div class="step" data-row="2" data-row-dir="1" style="--proc: #bde0fe;">
    <div class="bubble">9</div>
    <textarea class="title" rows="1" title="Nuevo paso" style="height: 24px;"></textarea>
    <div class="minis">
      <button class="mini" data-act="menu-toggle" title="Opciones de paso">âœï¸</button>
    </div><div class="step-menu hide">
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-branches" title="SÃ / NO">â“</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc" title="Adjuntar documento">ğŸ“</button>
  </div></div><div class="step-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del pasoâ€¦" title=""></textarea></div></div><div style="position: absolute; left: 491.5px; top: 384px;"><div class="step" data-row="3" data-row-dir="-1" style="--proc: #bde0fe;">
    <div class="bubble">10</div>
    <textarea class="title" rows="1" title="Nuevo paso" style="height: 24px;"></textarea>
    <div class="minis">
      <button class="mini" data-act="menu-toggle" title="Opciones de paso">âœï¸</button>
    </div><div class="step-menu hide">
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-branches" title="SÃ / NO">â“</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc" title="Adjuntar documento">ğŸ“</button>
  </div></div><div class="step-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del pasoâ€¦" title=""></textarea></div></div><div style="position: absolute; left: 167.5px; top: 384px;"><div class="step is-meta-step" data-row="3" data-row-dir="-1" style="--proc: #bde0fe;">
    <div class="bubble">11</div>
    <textarea class="title" rows="1" title="Nuevo paso" style="height: 24px;"></textarea>
    <div class="minis">
      <button class="mini" data-act="menu-toggle" title="Opciones de paso">âœï¸</button>
    </div><div class="step-menu hide">
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-branches" title="SÃ / NO">â“</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc" title="Adjuntar documento">ğŸ“</button>
  </div></div><div class="step-detail hide" aria-hidden="true" style="display: none;"><textarea placeholder="Detalle del pasoâ€¦" title=""></textarea></div></div><svg class="flow-svg" viewBox="0 0 948.6666870117188 530"><defs><marker id="arrowHead" markerWidth="7" markerHeight="7" refX="6" refY="3.5" orient="auto" markerUnits="strokeWidth"><path d="M0,0 L7,3.5 L0,7 Z" fill="#cbd5e1"></path></marker></defs><path d="M 300 48.16666793823242 L 329.5 48.16666793823242" fill="none" stroke="#cbd5e1" stroke-width="2.4" marker-end="url(#arrowHead)"></path><path d="M 619.5 48.16666793823242 L 649 48.16666793823242" fill="none" stroke="#cbd5e1" stroke-width="2.4" marker-end="url(#arrowHead)"></path><path d="M 794 96.33333587646484
           L 794 110.33333587646484
           L 724 110.33333587646484
           L 724 114
           L 794 114
           L 794 128" fill="none" stroke="#cbd5e1" stroke-width="2.4" marker-end="url(#arrowHead)"></path><path d="M 649 176.16666793823242 L 619.5 176.16666793823242" fill="none" stroke="#cbd5e1" stroke-width="2.4" marker-end="url(#arrowHead)"></path><path d="M 329.5 176.16666793823242 L 300 176.16666793823242" fill="none" stroke="#cbd5e1" stroke-width="2.4" marker-end="url(#arrowHead)"></path><path d="M 155 224.33333587646484
           L 155 238.33333587646484
           L 85 238.33333587646484
           L 85 242
           L 155 242
           L 155 256" fill="none" stroke="#cbd5e1" stroke-width="2.4" marker-end="url(#arrowHead)"></path><path d="M 300 304.1666679382324 L 329.5 304.1666679382324" fill="none" stroke="#cbd5e1" stroke-width="2.4" marker-end="url(#arrowHead)"></path><path d="M 619.5 304.1666679382324 L 649 304.1666679382324" fill="none" stroke="#cbd5e1" stroke-width="2.4" marker-end="url(#arrowHead)"></path><path d="M 794 352.33333587646484
           L 794 366.33333587646484
           L 724 366.33333587646484
           L 724 370.0000305175781
           L 636.5 370.0000305175781
           L 636.5 384.0000305175781" fill="none" stroke="#cbd5e1" stroke-width="2.4" marker-end="url(#arrowHead)"></path><path d="M 491.5 432.16669845581055 L 457.5 432.16669845581055" fill="none" stroke="#cbd5e1" stroke-width="2.4" marker-end="url(#arrowHead)"></path></svg></div></div></div>
  </div>

  <div id="procModal" class="hide" style="position:fixed;inset:0;background:rgba(0,0,0,.35);display:grid;place-items:center;z-index:50">
    <div style="background:#fff;border-radius:14px;min-width:320px;max-width:92vw;padding:10px;box-shadow:0 20px 40px rgba(0,0,0,.2)">
      <div style="font-weight:800;margin:.2rem .2rem .6rem">Selecciona proceso destino</div>
      <div id="procModalList" style="display:flex;flex-direction:column;gap:.35rem"></div>
      <div style="display:flex;justify-content:flex-end;margin-top:.6rem">
        <button id="pmCancel" class="btn3d" style="background:#ddd;color:#111;box-shadow:0 2px 8px rgba(0,0,0,.25)">Cancelar</button>
      </div>
    </div>
  </div>

  <input type="file" id="paFilePicker" style="display:none" multiple="">

<script>
function showBlock(el){ if(!el) return; el.classList.remove('hide'); el.style.display='block'; el.setAttribute('aria-hidden','false'); }
function hideBlock(el){ if(!el) return; el.classList.add('hide'); el.style.display='none'; el.setAttribute('aria-hidden','true'); }
function toggleBlock(el,open){ open ? showBlock(el) : hideBlock(el); }

/* ===== Estado ===== */
const LSKEY='pa_v4_dept_3d';

// Responsables por departamento
const RESPONSABLES_AUDIO=['AudiÃ³logo','Responsable','Otros'];
const RESPONSABLES_OPTICA=['Ã“ptico','Responsable','Comercial','Otros'];
const RESPONSABLES_PRODUCTO=['Responsable','Otros'];
function responsablesForDept(){
  try{
    const d = typeof currentDept==='function' ? currentDept() : null;
    const name = (d && (d.name||'')).toLowerCase();
    if(name.includes('Ã³ptica') || name.includes('optica') || name.includes('optic')){
      return RESPONSABLES_OPTICA;
    }
    if(name.includes('producto')){
      return RESPONSABLES_PRODUCTO;
    }
  }catch(e){}
  // Por defecto (AudiologÃ­a u otros)
  return RESPONSABLES_AUDIO;
}

const ROL_DESC={
  'AudiÃ³logo':'Profesional que evalÃºa, adapta y realiza el seguimiento audiolÃ³gico del paciente.',
  'Responsable':'Persona que coordina el proceso, valida y supervisa el cumplimiento del protocolo.',
  'Ã“ptico':'Profesional de la visiÃ³n responsable de la evaluaciÃ³n, adaptaciÃ³n y seguimiento de ayudas Ã³pticas.',
  'Comercial':'Perfil enfocado en la gestiÃ³n comercial y atenciÃ³n al cliente dentro del proceso.',
  'Otros':'Rol especÃ­fico definido en el campo "Nombre otrosâ€¦".'
};
const colors=['#ffd6a5','#bde0fe','#caffbf','#ffadad','#fdffb6','#bdb2ff','#ffc6ff','#a0e7e5','#c7f9cc','#fbcfe8','#fde68a','#bbf7d0'];
const uid=()=>'p'+Math.random().toString(36).slice(2,9);
const stamp=()=>{const d=new Date(),p=n=>n<10?'0'+n:n;return `${p(d.getDate())}/${p(dMonth(d))}/${p(d.getFullYear())}, ${p(d.getHours())}:${p(d.getMinutes())}:${p(d.getSeconds())}`};
function dMonth(d){return d.getMonth()+1;}

const state={departments:[], activeDeptId:null};
let activePid=null;
let pendingDocTarget=null;

function currentDept(){
  // Siempre usamos el departamento realmente seleccionado en el desplegable superior
  const sel = document.getElementById('deptSelect');
  const selId = sel && sel.value ? sel.value : state.activeDeptId;
  const d = state.departments.find(d=>d.id===selId);
  return d || state.departments[0] || null;
}
function currentProcesses(){
  const d=currentDept();
  return d ? (d.processes || []) : [];
}
function findProcessById(pid){
  return currentProcesses().find(p=>p.id===pid);
}

function save(){
  localStorage.setItem(LSKEY,JSON.stringify(state));
  document.getElementById('stamp').textContent='Ãšltima actualizaciÃ³n '+stamp();
}
function load(){
  let usedSnapshot=false;

  // 1) Si el HTML lleva un snapshot embebido (para compartir), lo usamos primero
  const snapEl=document.getElementById('paSnapshot');
  if(snapEl && snapEl.textContent){
    try{
      const data=JSON.parse(snapEl.textContent);
      if(data && Array.isArray(data.departments)){
        state.departments=data.departments;
        state.activeDeptId=data.activeDeptId || (data.departments[0]?.id||null);
        usedSnapshot=true;
      }
    }catch(e){}
  }

  // 2) Si no hay snapshot, usamos el localStorage como siempre
  if(!usedSnapshot){
    const raw=localStorage.getItem(LSKEY);
    if(!raw){
      state.departments=[];
      state.activeDeptId=null;
      save();
    }else{
      try{
        const data=JSON.parse(raw);
        if(Array.isArray(data.departments)){
          state.departments=data.departments;
          state.activeDeptId=data.activeDeptId || (data.departments[0]?.id||null);
        }else if(Array.isArray(data.processes)){
          const dId=uid();
          state.departments=[{
            id:dId,
            name:'Departamento 1',
            description:'',
            _openDesc:false,
            processes:data.processes
          }];
          state.activeDeptId=dId;
        }
      }catch(e){
        state.departments=[];
        state.activeDeptId=null;
      }
    }
  }

  /* detalle de departamento siempre plegado por defecto */
  if(Array.isArray(state.departments)){
    state.departments.forEach(d=>{
      if(!Array.isArray(d.processes)) d.processes=[];
      d._openDesc=false;
    });
  }
}

/* auto-resize tÃ­tulos paso */
function autoResize(el){
  if(!el) return;
  el.style.height='auto';
  const h = el.scrollHeight || 24;
  el.style.height = h + 'px';
}

/* ===== Procesos izquierda ===== */
function procRow(p){
  const wrap=document.createElement('div'); wrap.className='proc-item'+(p.id===activePid?' activo':'');
  wrap.dataset.pid = p.id;
  const row=document.createElement('div'); row.className='proc-row';
  row.innerHTML=`<span class="dot" style="background:${p.color}"></span>
    <span class="proc-name">${p.name}</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div>`;
  row.onclick=e=>{ if(e.target.closest('.icon-btn')) return; activePid=p.id; render(); };

  const det=document.createElement('div');
  det.className='proc-detail'+(p._openDetail?'':' hide');
  det.setAttribute('aria-hidden', p._openDetail ? 'false':'true');
  det.innerHTML=`<textarea placeholder="Detalle del procesoâ€¦">${p.detail||''}</textarea>`;
  const ta=det.querySelector('textarea');
  ta.oninput=e=>{ p.detail=e.target.value; ta.title=p.detail||''; save(); };

  const [bDet,bRen,bDel]=row.querySelectorAll('.icon-btn');
  bDet.onclick=e=>{
    e.stopPropagation();
    p._openDetail=!p._openDetail;
    toggleBlock(det,p._openDetail);
    if(p._openDetail) setTimeout(()=>ta.focus(),0);
    save();
  };
  bRen.onclick=e=>{ e.stopPropagation(); const nn=prompt('Nombre del proceso',p.name); if(nn){p.name=nn;save();render();} };
  bDel.onclick=e=>{
    e.stopPropagation();
    if(confirm('Â¿Eliminar proceso y sus mÃ³dulos?')){
      const dept=currentDept(); if(!dept) return;
      const i=dept.processes.findIndex(x=>x.id===p.id);
      if(i>-1){
        dept.processes.splice(i,1);
        const procs=currentProcesses();
        activePid=procs[0]?.id||null;
        save();
        render();
      }
    }
  };

  wrap.appendChild(row); wrap.appendChild(det);
  return wrap;
}
function renderProcesses(){
  const box=document.getElementById('processList'); if(!box) return;
  box.innerHTML='';
  const dept=currentDept();
  if(!dept){
    box.innerHTML='<div style="font-size:12px;color:#6b7280;padding:4px 4px 6px;">Crea un departamento con â€œDepartamentos+â€ y luego aÃ±ade sus procesos.</div>';
    return;
  }
  if(!Array.isArray(dept.processes)) dept.processes=[];
  dept.processes.forEach(p=>box.appendChild(procRow(p)));
}

/* ===== Dept info izquierda (lÃ¡piz) ===== */
function renderDeptInfo(){
  const box=document.getElementById('deptInfo'); if(!box) return;
  box.innerHTML='';
  const dept=currentDept();
  if(!dept){
    box.innerHTML='';
    return;
  }
  const wrap=document.createElement('div');
  wrap.className='dept-info-box';

  const header=document.createElement('div');
  header.className='dept-info-header';

  header.innerHTML = `<span class="dot" style="background:#bdbdbd"></span>
    <span class="dept-info-title">Departamento: ${(dept.name || 'Sin nombre')}</span>
    <div class="proc-acts">
      <button class="icon-btn" title="Detalle">â–¾</button>
      <button class="icon-btn" title="Renombrar">âœï¸</button>
      <button class="icon-btn" title="Eliminar" style="box-shadow:inset 0 0 0 #fff">ğŸ—‘ï¸</button>
    </div>`;

  const desc=document.createElement('div');
  desc.classList.add('dept-desc');
  if(!dept._openDesc) desc.classList.add('hide');
  desc.setAttribute('aria-hidden', dept._openDesc ? 'false':'true');
  desc.innerHTML = `<textarea>${dept.description||''}</textarea>`;
  const ta=desc.querySelector('textarea');
  ta.oninput=e=>{
    dept.description=e.target.value;
    save();
  };

  const btns = header.querySelectorAll('.icon-btn');
  const bDet = btns[0];
  const bRen = btns[1];
  const bDel = btns[2];

  bDet.onclick=(e)=>{
    e.stopPropagation();
    dept._openDesc = !dept._openDesc;
    toggleBlock(desc, dept._openDesc);
    save();
  };

  bRen.onclick=(e)=>{
    e.stopPropagation();
    const locked = sessionStorage.getItem('PA_PIN_OK')!=='1';
    if(locked){
      if(window.paToastFn) window.paToastFn('Modo lectura: bloqueado por PIN');
      return;
    }
    const nn=prompt('Nombre del departamento', dept.name || '');
    if(nn){
      dept.name=nn;
      save();
      render();
    }
  };

  bDel.onclick=(e)=>{
    e.stopPropagation();
    const locked = sessionStorage.getItem('PA_PIN_OK')!=='1';
    if(locked){
      if(window.paToastFn) window.paToastFn('Modo lectura: bloqueado por PIN');
      return;
    }
    if(!confirm('Â¿Eliminar departamento y todos sus procesos?')) return;
    const idx=state.departments.findIndex(d=>d.id===dept.id);
    if(idx>-1){
      state.departments.splice(idx,1);
      if(state.departments.length){
        const next=state.departments[Math.min(idx,state.departments.length-1)];
        state.activeDeptId=next.id;
        activePid=null;
      }else{
        state.activeDeptId=null;
        activePid=null;
      }
      save();
      render();
    }
  };

  wrap.appendChild(header);
  wrap.appendChild(desc);
  box.appendChild(wrap);
}

/* ===== Dept selector topbar ===== */
function renderDeptSelect(){
  const sel=document.getElementById('deptSelect');
  if(!sel) return;
  sel.innerHTML='';
  if(!state.departments.length){
    const opt=document.createElement('option');
    opt.value='';
    opt.textContent='(Sin departamentos)';
    sel.appendChild(opt);
    sel.disabled=true;
    return;
  }
  sel.disabled=false;
  state.departments.forEach(d=>{
    const o=document.createElement('option');
    o.value=d.id;
    o.textContent=d.name || 'Sin nombre';
    if(d.id===state.activeDeptId) o.selected=true;
    sel.appendChild(o);
  });
}
function handleDeptChange(value){
  if(!value){
    state.activeDeptId = state.departments[0]?.id || null;
  }else{
    state.activeDeptId = value;
  }
  const dept=currentDept();
  if(dept){
    if(!Array.isArray(dept.processes)) dept.processes=[];
    activePid = dept.processes[0]?.id || null;
  }else{
    activePid=null;
  }
  save();
  render();
}

/* ===== Modal bandera ===== */
function openProcPicker(onPick){
  const modal=document.getElementById('procModal');
  const list=document.getElementById('procModalList'); list.innerHTML='';
  const procs=currentProcesses();
  procs.forEach(p=>{
    const b=document.createElement('button');
    b.className='btn3d'; b.style.cssText='justify-content:flex-start;color:#111;background:#fff;box-shadow:0 1px 0 rgba(0,0,0,.06);border-radius:12px';
    b.innerHTML=`<span class="dot" style="background:${p.color}"></span> <strong>${p.name}</strong>`;
    b.onclick=()=>{ modal.classList.add('hide'); onPick(p.id); };
    list.appendChild(b);
  });
  document.getElementById('pmCancel').onclick=()=>modal.classList.add('hide');
  modal.classList.remove('hide');
}

/* ===== helpers pasos ===== */
function makeStep(){
  return {
    id:uid(),
    title:'Nuevo paso',
    detail:'',
    link:null,
    links:[],
    docs:[],
    yes:[],
    no:[],
    yesLink:null,
    noLink:null,
    subSteps:[],
    _openBranches:false,
    _editingBranches:false,
    _openDetailStep:false
  };
}
function pushPoint(arr){ arr.push({id:uid(),text:'',children:[]}); }
function pushSubPoint(pt){ if(!Array.isArray(pt.children)) pt.children=[]; pt.children.push({id:uid(),text:''}); }
function delFromArray(arr,id){ const i=arr.findIndex(x=>x.id===id); if(i>-1) arr.splice(i,1); }

/* ===== Layout serpentina ===== */
function layoutStepsSerpentine(container){
  const wrappers = Array.from(container.children).filter(w => w.querySelector('.step'));
  if(!wrappers.length) return;

  wrappers.forEach(w=>{
    w.style.position='';
    w.style.left='';
    w.style.top='';
  });

  const firstStep = wrappers[0].querySelector('.step');
  if(!firstStep) return;

  const cardW = firstStep.offsetWidth || 290;
  const desiredGapX = 34;
  const gapY = 24;

  const containerWidthRaw = container.clientWidth || (cardW+desiredGapX);
  const cols = Math.min(3, wrappers.length);
  const heights = wrappers.map(w => w.offsetHeight);

  const rows = [];
  wrappers.forEach((w,idx)=>{
    const r = Math.floor(idx / cols);
    if(!rows[r]) rows[r]=[];
    rows[r].push(idx);
  });

  const rowHeights = [];
  rows.forEach((idxs,r)=>{
    let maxH = 0;
    idxs.forEach(i=>{
      if(heights[i]>maxH) maxH = heights[i];
    });
    rowHeights[r] = maxH + 8;
  });

  let y = 0;

  rows.forEach((idxs,r)=>{
    const dirRight = r%2===0;
    const itemsInRow = idxs.length;

    const availableWidth = Math.max(containerWidthRaw - 20, cardW*itemsInRow);
    let gapX = desiredGapX;
    let totalWidth = cardW*itemsInRow + gapX*(itemsInRow-1);

    if(totalWidth > availableWidth && itemsInRow>1){
      gapX = Math.max(16, (availableWidth - cardW*itemsInRow)/(itemsInRow-1));
      totalWidth = cardW*itemsInRow + gapX*(itemsInRow-1);
    }

    let baseX = (containerWidthRaw - totalWidth)/2;
    if(baseX < 6) baseX = 6;

    idxs.forEach((idx,pos)=>{
      const wrap = wrappers[idx];
      const colInRow = dirRight ? pos : (itemsInRow-1-pos);
      const left = baseX + colInRow*(cardW+gapX);

      wrap.style.position='absolute';
      wrap.style.left = left+'px';
      wrap.style.top  = y+'px';

      const step = wrap.querySelector('.step');
      if(step){
        step.dataset.row = r;
        step.dataset.rowDir = dirRight ? '1':'-1';
      }
    });

    y += rowHeights[r] + gapY;
  });

  container.style.height = y + 18 + 'px';
}
function layoutAllSteps(){
  document.querySelectorAll('.steps').forEach(layoutStepsSerpentine);
}

/* ===== Flechas ===== */
function drawFlowForSteps(container){
  const wrappers = Array.from(container.children).filter(w => w.querySelector('.step'));
  const steps = wrappers.map(w => w.querySelector('.step')).filter(Boolean);
  if(!steps.length) return;

  steps.forEach(s=>s.classList.remove('is-meta-step'));

  const old = container.querySelector('.flow-svg');
  if(old) old.remove();

  const cRect = container.getBoundingClientRect();
  const svgNS = 'http://www.w3.org/2000/svg';
  const svg = document.createElementNS(svgNS,'svg');
  svg.classList.add('flow-svg');
  svg.setAttribute('viewBox',`0 0 ${cRect.width} ${cRect.height}`);

  const defs=document.createElementNS(svgNS,'defs');
  const markerSmall=document.createElementNS(svgNS,'marker');
  markerSmall.setAttribute('id','arrowHead');
  markerSmall.setAttribute('markerWidth','7');
  markerSmall.setAttribute('markerHeight','7');
  markerSmall.setAttribute('refX','6');
  markerSmall.setAttribute('refY','3.5');
  markerSmall.setAttribute('orient','auto');
  markerSmall.setAttribute('markerUnits','strokeWidth');
  const headSmall=document.createElementNS(svgNS,'path');
  headSmall.setAttribute('d','M0,0 L7,3.5 L0,7 Z');
  headSmall.setAttribute('fill','#cbd5e1');
  markerSmall.appendChild(headSmall);
  defs.appendChild(markerSmall);
  svg.appendChild(defs);

  const rects = steps.map(s => s.getBoundingClientRect());

  const lastStepEl = steps[steps.length-1];
  lastStepEl.classList.add('is-meta-step');

  function addPath(d){
    const path=document.createElementNS(svgNS,'path');
    path.setAttribute('d',d);
    path.setAttribute('fill','none');
    path.setAttribute('stroke','#cbd5e1');
    path.setAttribute('stroke-width','2.4');
    path.setAttribute('marker-end','url(#arrowHead)');
    svg.appendChild(path);
  }

  function anchor(rect, side){
    const xLeft = rect.left - cRect.left;
    const xRight = rect.right - cRect.left;
    const yTop = rect.top - cRect.top;
    const yBottom = rect.bottom - cRect.top;
    const yMid = (yTop + yBottom)/2;
    const xMid = (xLeft + xRight)/2;
    switch(side){
      case 'left': return {x:xLeft,y:yMid};
      case 'right': return {x:xRight,y:yMid};
      case 'top': return {x:xMid,y:yTop};
      case 'bottom': return {x:xMid,y:yBottom};
    }
  }

  function getBranchesRectForStep(stepEl){
    if(!stepEl || !stepEl.parentElement) return null;
    const parent = stepEl.parentElement;
    const br = parent.querySelector('.branches');
    const ind = parent.querySelector('.branch-indicator');
    if(!br && !ind) return null;

    let top = Infinity, bottom = -Infinity, left = Infinity, right = -Infinity;

    if(br && !br.classList.contains('hide')){
      const r = br.getBoundingClientRect();
      top = Math.min(top, r.top);
      bottom = Math.max(bottom, r.bottom);
      left = Math.min(left, r.left);
      right = Math.max(right, r.right);
    }
    if(ind && !ind.classList.contains('hide')){
      const r = ind.getBoundingClientRect();
      top = Math.min(top, r.top);
      bottom = Math.max(bottom, r.bottom);
      left = Math.min(left, r.left);
      right = Math.max(right, r.right);
    }
    if(bottom===-Infinity) return null;
    return {top,bottom,left,right};
  }

  for(let i=0;i<rects.length-1;i++){
    const a = rects[i];
    const b = rects[i+1];
    const stepA = steps[i];
    const stepB = steps[i+1];
    const rowA = parseInt(stepA.dataset.row || '0',10);
    const rowB = parseInt(stepB.dataset.row || '0',10);

    let d;

    if(rowA === rowB){
      // Flechas horizontales alineadas en cada fila.
      // En filas hacia la derecha (rowDir=1): de derecha del paso origen a izquierda del siguiente.
      // En filas hacia la izquierda (rowDir=-1): de izquierda del paso origen a derecha del siguiente.
      const dir = parseInt(stepA.dataset.rowDir || '1',10);
      let from,to;
      if(dir === 1){
        from = anchor(a,'right');
        to   = anchor(b,'left');
      }else{
        from = anchor(a,'left');
        to   = anchor(b,'right');
      }
      d = `M ${from.x} ${from.y} L ${to.x} ${from.y}`;
    }else{
      const bottomA = anchor(a,'bottom');
      const topB    = anchor(b,'top');
      const brRect  = getBranchesRectForStep(stepA);

      const start = {x:bottomA.x, y:bottomA.y};

      let yDown = bottomA.y + 14;
      if(brRect){
        const brBottom = brRect.bottom - cRect.top;
        if(brBottom + 16 > yDown) yDown = brBottom + 16;
      }

      let yUp = topB.y - 14;

      const allLefts  = rects.map(r => r.left - cRect.left);
      const allRights = rects.map(r => r.right - cRect.left);
      const minX = Math.min.apply(null,allLefts);
      const maxX = Math.max.apply(null,allRights);
      let corridorX = start.x - 70;
      if(corridorX < minX - 30){
        corridorX = minX - 30;
      }
      if(corridorX < 8){
        corridorX = maxX + 34;
      }

      d = `M ${start.x} ${start.y}
           L ${start.x} ${yDown}
           L ${corridorX} ${yDown}
           L ${corridorX} ${yUp}
           L ${topB.x} ${yUp}
           L ${topB.x} ${topB.y}`;
    }
    addPath(d);
  }

  container.appendChild(svg);
}
function drawAllFlows(){
  document.querySelectorAll('.steps').forEach(drawFlowForSteps);
}

/* ===== SÃ / NO ===== */
function branchBox(p,m,st,kind,idx){
  const isYes = kind==='yes';
  const arr = st[kind] || (st[kind]=[]);
  const wrap=document.createElement('div'); wrap.className='branch '+(isYes?'yes':'no');

  const hasContent = arr.length>0 || (st[kind+'Link'] && st[kind+'Link'].pid);
  if(hasContent) wrap.classList.add('branch-has-content');

  const top=document.createElement('div'); top.className='bh-top';
  const label=document.createElement('div'); label.className='bh-label'; label.textContent=isYes?'SÃ':'NO';
  const right=document.createElement('div'); right.className='bh-top-right';

  const add=document.createElement('button'); add.className='p-mini'; add.textContent='ï¼‹'; add.title='AÃ±adir punto';
  const flag=document.createElement('button'); flag.className='p-mini'; flag.textContent='ğŸš©'; flag.title='Bandera rama';
  const delBranch=document.createElement('button'); delBranch.className='p-mini'; delBranch.textContent='ğŸ—‘'; delBranch.title='Borrar rama';

  add.onclick=()=>{ st._openBranches=true; st._editingBranches=true; pushPoint(arr); save(); renderModules(); };
  flag.onclick=()=>{ st._openBranches=true; st._editingBranches=true; openProcPicker(pid=>{ st[kind+'Link']={pid}; save(); renderModules(); }); };
  delBranch.onclick=()=>{
    if(!arr.length && !st[kind+'Link']) return;
    if(confirm('Â¿Borrar puntos de esta rama y su bandera?')){
      st[kind]=[];
      delete st[kind+'Link'];
      save();
      renderModules();
    }
  };

  right.appendChild(add);
  right.appendChild(flag);
  right.appendChild(delBranch);

  top.appendChild(label);
  top.appendChild(right);

  if(st[kind+'Link']?.pid){
    const dest=currentProcesses().find(x=>x.id===st[kind+'Link'].pid);
    if(dest){
      const chip=document.createElement('span'); chip.className='chip'; chip.style.background=dest.color; chip.style.marginLeft='.25rem';
      chip.innerHTML=`â†’ <small>Proceso:</small> <strong>${dest.name}</strong>`;
      top.appendChild(chip);
    }
  }
  wrap.appendChild(top);

  const list=document.createElement('div'); list.className='plist';

  arr.forEach((pt)=>{
    if(!Array.isArray(pt.children)) pt.children=[];
    const li=document.createElement('div'); li.className='point';

    const numSpan=document.createElement('span');
    numSpan.className='num';
    numSpan.textContent='';

    const input=document.createElement('input');
    input.className='pt-input';
    input.placeholder='Escribeâ€¦';
    input.value=pt.text||'';
    input.title=pt.text||'';
    input.oninput=e=>{ pt.text=e.target.value; input.title=pt.text||''; save(); };

    const actions=document.createElement('div');
    actions.className='p-actions';

    const toggle=document.createElement('button');
    toggle.className='p-mini p-toggle';
    toggle.title='MÃ¡s opciones';
    toggle.textContent='ï¼‹';

    const extra=document.createElement('div');
    extra.className='p-extra hide';

    const bSub=document.createElement('button');
    bSub.className='p-mini';
    bSub.title='Subpunto';
    bSub.textContent='ï¼‹';
    bSub.onclick=()=>{
      st._openBranches=true;
      st._editingBranches=true;
      pushSubPoint(pt);
      save();
      renderModules();
    };

    const bFlag=document.createElement('button');
    bFlag.className='p-mini';
    bFlag.title='Bandera';
    bFlag.textContent='ğŸš©';
    bFlag.onclick=()=>{
      st._openBranches=true;
      st._editingBranches=true;
      openProcPicker(pid=>{
        pt.link={pid};
        save();
        renderModules();
      });
    };

    const bDel=document.createElement('button');
    bDel.className='p-mini';
    bDel.title='Borrar';
    bDel.textContent='ğŸ—‘';
    bDel.onclick=()=>{
      st._openBranches=true;
      st._editingBranches=true;
      delFromArray(arr,pt.id);
      save();
      renderModules();
    };

    extra.appendChild(bSub);
    extra.appendChild(bFlag);
    extra.appendChild(bDel);

    toggle.onclick=()=>{
      st._openBranches=true;
      st._editingBranches=true;
      extra.classList.toggle('hide');
    };

    actions.appendChild(toggle);
    actions.appendChild(extra);

    li.appendChild(numSpan);
    li.appendChild(input);
    li.appendChild(actions);

    if(pt.link?.pid){
      const dest=currentProcesses().find(x=>x.id===pt.link.pid);
      if(dest){
        const pc=document.createElement('span'); pc.className='chip'; pc.style.background=dest.color; pc.style.marginLeft='.25rem';
        pc.innerHTML=`â†’ <small>${dest.name}</small>`;
        li.appendChild(pc);
      }
    }

    list.appendChild(li);

    const kids=document.createElement('div'); kids.className='children';
    pt.children.forEach((ch)=>{
      const cli=document.createElement('div'); cli.className='point';

      const cNumSpan=document.createElement('span');
      cNumSpan.className='num';
      cNumSpan.textContent='';

      const cInput=document.createElement('input');
      cInput.className='pt-input';
      cInput.placeholder='Subpuntoâ€¦';
      cInput.value=ch.text||'';
      cInput.title=ch.text||'';
      cInput.oninput=e=>{ ch.text=e.target.value; cInput.title=ch.text||''; save(); };

      const cActions=document.createElement('div');
      cActions.className='p-actions';

      const cToggle=document.createElement('button');
      cToggle.className='p-mini p-toggle';
      cToggle.title='MÃ¡s opciones';
      cToggle.textContent='ï¼‹';

      const cExtra=document.createElement('div');
      cExtra.className='p-extra hide';

      const cbFlag=document.createElement('button');
      cbFlag.className='p-mini';
      cbFlag.title='Bandera';
      cbFlag.textContent='ğŸš©';
      cbFlag.onclick=()=>{
        st._openBranches=true;
        st._editingBranches=true;
        openProcPicker(pid=>{
          ch.link={pid};
          save();
          renderModules();
        });
      };

      const cbDel=document.createElement('button');
      cbDel.className='p-mini';
      cbDel.title='Borrar';
      cbDel.textContent='ğŸ—‘';
      cbDel.onclick=()=>{
        st._openBranches=true;
        st._editingBranches=true;
        const k=pt.children.indexOf(ch);
        if(k>-1){
          pt.children.splice(k,1);
          save();
          renderModules();
        }
      };

      cExtra.appendChild(cbFlag);
      cExtra.appendChild(cbDel);

      cToggle.onclick=()=>{
        st._openBranches=true;
        st._editingBranches=true;
        cExtra.classList.toggle('hide');
      };

      cActions.appendChild(cToggle);
      cActions.appendChild(cExtra);

      cli.appendChild(cNumSpan);
      cli.appendChild(cInput);
      cli.appendChild(cActions);

      if(ch.link?.pid){
        const dest=currentProcesses().find(x=>x.id===ch.link.pid);
        if(dest){
          const cc=document.createElement('span'); cc.className='chip'; cc.style.background=dest.color; cc.innerHTML=`â†’ <small>${dest.name}</small>`;
          cli.appendChild(cc);
        }
      }

      kids.appendChild(cli);
    });

    list.appendChild(kids);
  });

  wrap.appendChild(list);
  return wrap;
}

/* ===== Paso ===== */

function stepRow(p,m,st,index){
  const row=document.createElement('div');

  const sc=document.createElement('div'); sc.className='step';
  sc.innerHTML=`
    <div class="step-mainline">
      <div class="bubble">${index+1}</div>
      <textarea class="title" rows="1"></textarea>
    </div>
    <div class="minis">
      <button class="mini" data-act="step-extra" title="AÃ±adir sub-paso">+</button>
      <button class="mini mini-attach" data-act="step-attach" title="Ver enlaces y documentos">ğŸ‘‡</button>
      <button class="mini" data-act="step-del" title="Eliminar paso">âˆ’</button>
      <button class="mini" data-act="menu-toggle" title="Opciones de paso">âœï¸</button>
    </div>`;
  sc.style.setProperty('--proc',p.color);
  sc.addEventListener('click', (e)=>{
    const isMini  = e.target.closest('.mini') || e.target.closest('.step-menu');
    const isTitle = e.target.classList.contains('title') || (e.target.closest && e.target.closest('.title'));
    if(isMini || isTitle) return;

    const stepsWrap = sc.closest('.steps');
    if(stepsWrap){
      stepsWrap.querySelectorAll('.step').forEach(s=>s.classList.remove('selected'));
    }
    sc.classList.add('selected');

    // Toggle de apertura/cierre del detalle del paso al clicar la caja
    st._openDetailStep = !st._openDetailStep;
    save();
    if(typeof renderModules==='function') renderModules();
  });

  const titleInput = sc.querySelector('.title');
  titleInput.value = st.title || '';
  titleInput.title = st.title || '';
  autoResize(titleInput);
  titleInput.addEventListener('input', e=>{
    st.title = e.target.value;
    titleInput.title = st.title || '';
    autoResize(titleInput);
    save();
  });

  const menu=document.createElement('div');
  menu.className='step-menu hide';
  menu.innerHTML=`
    <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
    <button data-act="menu-detail" title="Detalle del paso">ğŸ“</button>
    <button data-act="menu-delete" title="Eliminar paso">ğŸ—‘</button>
    <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
    <button data-act="menu-doc"  title="Adjuntar documento">ğŸ“</button>
  `;
  sc.appendChild(menu);

  const stepDetail=document.createElement('div');
  stepDetail.className='step-detail'+(st._openDetailStep?'':' hide');
  stepDetail.innerHTML=`<textarea placeholder="Detalle del pasoâ€¦">${st.detail||''}</textarea>`;
  const sdTa = stepDetail.querySelector('textarea');
  sdTa.title = st.detail || '';
  if(typeof autoResize === 'function'){ autoResize(sdTa); }
  sdTa.oninput = e=>{
    st.detail = e.target.value;
    sdTa.title=st.detail||'';
    if(typeof autoResize === 'function'){ autoResize(sdTa); }
    save();
  };

  if(!Array.isArray(st.links)) st.links=[];
  if(!Array.isArray(st.docs))  st.docs=[];
  if(!Array.isArray(st.subSteps)) st.subSteps=[];

  // Bloque visible de enlaces y documentos
  const attachWrap=document.createElement('div');
  attachWrap.className='step-attachments';

  if(st.links.length){
    const linksDiv=document.createElement('div');
    linksDiv.className='step-links';
    const label=document.createElement('span');
    label.className='label';
    label.textContent='Enlaces:';
    linksDiv.appendChild(label);
    st.links.forEach((url,i)=>{
      const item=document.createElement('span');
      item.className='attach-chip';
      const a=document.createElement('a');
      a.href=url;
      a.target='_blank';
      a.rel='noopener noreferrer';
      a.textContent=`${i+1}`;
      a.title=url;
      item.appendChild(a);
      const del=document.createElement('button');
      del.type='button';
      del.className='mini mini-attach-del';
      del.textContent='âˆ’';
      del.setAttribute('data-act','attach-del');
      del.dataset.kind='link';
      del.dataset.index=String(i);
      item.appendChild(del);
      linksDiv.appendChild(item);
    });
    attachWrap.appendChild(linksDiv);
  }

  if(st.docs.length){
    const docsDiv=document.createElement('div');
    docsDiv.className='step-docs';
    const label=document.createElement('span');
    label.className='label';
    label.textContent='Docs:';
    docsDiv.appendChild(label);
    st.docs.forEach((doc,i)=>{
      const item=document.createElement('span');
      item.className='attach-chip';
      let el=document.createElement('a');
      let href;
      let label;
      if(typeof doc==='string'){
        href = doc;
        label = doc;
      }else if(doc && doc.data){
        href = doc.data;
        label = doc.name || ('Doc '+(i+1));
      }
      if(href){
        el.href = href;
        el.target = '_blank';
        el.rel = 'noopener noreferrer';
        el.textContent = label || ('Doc '+(i+1));
        item.appendChild(el);
      }
      const del=document.createElement('button');
      del.type='button';
      del.className='mini mini-attach-del';
      del.textContent='âˆ’';
      del.setAttribute('data-act','attach-del');
      del.dataset.kind='doc';
      del.dataset.index=String(i);
      item.appendChild(del);
      docsDiv.appendChild(item);
    });
    attachWrap.appendChild(docsDiv);
  }

  if(attachWrap.childNodes.length){
    stepDetail.appendChild(attachWrap);

    // manejadores de borrado de adjuntos
    attachWrap.querySelectorAll('button[data-act="attach-del"]').forEach(btn=>{
      btn.onclick = (ev)=>{
        ev.stopPropagation();
        const kind = btn.dataset.kind;
        const idx  = parseInt(btn.dataset.index||'-1',10);
        if(Number.isNaN(idx)) return;
        if(kind==='link'){
          st.links.splice(idx,1);
        }else if(kind==='doc'){
          st.docs.splice(idx,1);
        }
        save();
        if(typeof renderModules==='function') renderModules();
      };
    });
  }

  const miniMenu = sc.querySelector('[data-act="menu-toggle"]');
  const btnExtra = sc.querySelector('[data-act="step-extra"]');
  const btnAttach = sc.querySelector('[data-act="step-attach"]');
  if(btnAttach){
    if(!(st.links.length || st.docs.length)){
      btnAttach.style.display='none';
    }else{
      btnAttach.style.display='';
      const totalAdj = (Array.isArray(st.links)?st.links.length:0) + (Array.isArray(st.docs)?st.docs.length:0);
      // Mano protagonista + nÃºmero pequeÃ±o al lado derecho (ej: â˜3)
      if(totalAdj>0){
        btnAttach.innerHTML = 'â˜<span class="mini-count">'+String(totalAdj)+'</span>';
      }else{
        btnAttach.textContent = 'ğŸ‘‡';
      }
      btnAttach.onclick = (ev)=>{
        ev.stopPropagation();
        if(!st.links.length && !st.docs.length){
          if(window.paToastFn) window.paToastFn('Este paso no tiene adjuntos.');
          return;
        }

        // Construir lista de adjuntos (enlaces + docs) para elegir
        const items = [];

        if(Array.isArray(st.links)){
          st.links.forEach((url,i)=>{
            if(!url) return;
            items.push({
              label:'Enlace '+(i+1),
              url:String(url)
            });
          });
        }
        if(Array.isArray(st.docs)){
          st.docs.forEach((doc,i)=>{
            if(!doc) return;
            if(typeof doc==='string'){
              items.push({
                label:doc,
                url:String(doc)
              });
            }else if(doc.data){
              items.push({
                label:doc.name || ('Doc '+(i+1)),
                url:String(doc.data)
              });
            }
          });
        }

        if(!items.length){
          if(window.paToastFn) window.paToastFn('Este paso no tiene adjuntos vÃ¡lidos.');
          return;
        }

        const openUrl = (url)=>{
          if(!url) return;
          try{
            window.open(url,'_blank','noopener');
          }catch(e){}
        };

        if(items.length===1){
          openUrl(items[0].url);
          return;
        }

        // Varios documentos: preguntar cuÃ¡l abrir
        const msg = 'Selecciona el documento que quieres abrir:\n\n' +
          items.map((it,idx)=> (idx+1)+'. '+it.label).join('\n');
        const ans = prompt(msg,'1');
        if(!ans) return;
        const idx = parseInt(ans,10);
        if(isNaN(idx) || idx<1 || idx>items.length) return;
        openUrl(items[idx-1].url);
      };
    }
  }

  const btnDel   = sc.querySelector('[data-act="step-del"]');

  function doFlag(){
    openProcPicker(pid=>{ st.link={pid}; save(); renderModules(); });
  }
  function doBranches(){
    const yesHas = (st.yes && st.yes.length>0) || (st.yesLink && st.yesLink.pid);
    const noHas  = (st.no  && st.no.length>0)  || (st.noLink  && st.noLink.pid);
    const hasAny = yesHas || noHas;

    if(st._editingBranches){
      st._editingBranches=false;
      st._openBranches=false;
    }else{
      st._editingBranches=true;
      st._openBranches=true;
      if(!hasAny){
        if(!Array.isArray(st.yes)) st.yes=[];
        if(st.yes.length===0) pushPoint(st.yes);
      }
    }
    save();
    renderModules();
  }
  function doDetail(){
    st._openDetailStep = !st._openDetailStep;
    save();
    renderModules();
  }
  function doDelete(){
    m.steps.splice(index,1);
    save();
    renderModules();
  }

  if(btnExtra){
    btnExtra.onclick = (ev)=>{
      ev.stopPropagation();
      if(!Array.isArray(st.subSteps)) st.subSteps=[];
      const sub = makeStep();
      sub.title = 'Sub-paso';
      st.subSteps.push(sub);
      save();
      renderModules();
    };
  }
  if(btnDel){
    btnDel.onclick = (ev)=>{
      ev.stopPropagation();
      if(confirm('Â¿Eliminar paso?')) doDelete();
    };
  }

  miniMenu.onclick=(ev)=>{
    ev.stopPropagation();
    menu.classList.toggle('hide');
  };

  const menuFlag     = menu.querySelector('[data-act="menu-flag"]');
  const menuBranches = menu.querySelector('[data-act="menu-branches"]');
  const menuDetail   = menu.querySelector('[data-act="menu-detail"]');
  const menuDelete   = menu.querySelector('[data-act="menu-delete"]');
  const menuLink     = menu.querySelector('[data-act="menu-link"]');
  const menuDoc      = menu.querySelector('[data-act="menu-doc"]');

  if(menuFlag)     menuFlag.onclick     = ()=>{ doFlag(); menu.classList.add('hide'); };
  if(menuBranches) menuBranches.onclick = ()=>{ doBranches(); menu.classList.add('hide'); };
  if(menuDetail)   menuDetail.onclick   = ()=>{ doDetail(); menu.classList.add('hide'); };
  if(menuDelete)   menuDelete.onclick   = ()=>{ if(confirm('Â¿Eliminar paso?')) doDelete(); menu.classList.add('hide'); };
  if(menuLink)     menuLink.onclick=()=>{
    const url = prompt('Enlace a adjuntar (URL o referencia):', '');
    if(url){
      st.links.push(url);
      miniMenu.title = `Opciones de paso (enlaces: ${st.links.length}, docs: ${st.docs.length})`;
      save();
      if(typeof renderModules==='function') renderModules();
    }
    menu.classList.add('hide');
  };
  menuDoc.onclick=()=>{
    pendingDocTarget = st;
    const fp=document.getElementById('paFilePicker');
    if(fp){
      fp.value='';
      fp.click();
    }
    menu.classList.add('hide');
  };

  if(st.links.length || st.docs.length){
    miniMenu.title = `Opciones de paso (enlaces: ${st.links.length}, docs: ${st.docs.length})`;
  }

  // Bandera + etiqueta del proceso dentro de la caja de origen
  if(st.link?.pid){
    const dest=currentProcesses().find(x=>x.id===st.link.pid);
    if(dest){
      const chip=document.createElement('div');
      chip.className='chip';
      chip.style.background=dest.color;
      chip.style.margin='3px 0 0 48px';
      chip.style.cursor='pointer';
      chip.innerHTML=`â†’ <small>Ir al proceso:</small> <strong>${dest.name}</strong>`;

      chip.onclick=(ev)=>{
        if(dest && dest.id){
          activePid = dest.id;
          save();
          render();
          const procEl=document.querySelector('.proc-item[data-pid="'+dest.id+'"]');
          if(procEl){
            procEl.scrollIntoView({behavior:'smooth',block:'nearest'});
          }
        }
      };

      sc.appendChild(chip);
    }
  }

  // El detalle del paso va dentro de la caja
  sc.appendChild(stepDetail);

  row.appendChild(sc);

  // SUB-PASOS (subSteps) debajo del paso principal
  function renderSubStep(ss, sIndex){
    const sRow=document.createElement('div');
    sRow.className='step-extra';

    const sCard=document.createElement('div');
    sCard.className='step sub-step';
    sCard.innerHTML=`
      <div class="sub-headline">
        <div class="bubble">En caso de:</div>
        <textarea class="title" rows="1" placeholder="Describe la casuÃ­sticaâ€¦"></textarea>
        <div class="minis">
          <button class="mini mini-attach" data-act="sub-attach" title="Ver enlaces y documentos">ğŸ‘‡</button>
          <button class="mini" data-act="sub-delete" title="Eliminar sub-paso">âˆ’</button>
          <button class="mini" data-act="menu-toggle" title="Opciones de sub-paso">âœï¸</button>
        </div>
      </div>`;

    sCard.style.setProperty('--proc', p.color);

    const tSub = sCard.querySelector('.title');
    tSub.value = ss.title || '';
    tSub.title = ss.title || '';
    autoResize(tSub);
    tSub.addEventListener('input', e=>{
      ss.title = e.target.value;
      tSub.title = ss.title || '';
      autoResize(tSub);
      save();
    });

    sCard.addEventListener('click', (e)=>{
      const isMini = e.target.closest('.mini') || e.target.closest('.step-menu');
      const isTitle = e.target.classList && (e.target.classList.contains('title') || (e.target.closest && e.target.closest('.title')));
      if(isMini || isTitle) return;
      ss._openDetailStep = !ss._openDetailStep;
      save();
      if(typeof renderModules==='function') renderModules();
    });

    const menuSub=document.createElement('div');
    menuSub.className='step-menu hide';
    menuSub.innerHTML=`
      <button data-act="menu-flag" title="Bandera proceso">ğŸš©</button>
      <button data-act="menu-detail" title="Detalle del sub-paso">ğŸ“</button>
      <button data-act="menu-delete" title="Eliminar sub-paso">ğŸ—‘</button>
      <button data-act="menu-link" title="Adjuntar enlace">ğŸ”—</button>
      <button data-act="menu-doc"  title="Adjuntar documento">ğŸ“</button>
    `;
    sCard.appendChild(menuSub);

    if(!Array.isArray(ss.links)) ss.links=[];
    if(!Array.isArray(ss.docs))  ss.docs=[];

    const subDetail=document.createElement('div');
    subDetail.className='step-detail'+(ss._openDetailStep?'':' hide');
    subDetail.innerHTML=`<textarea placeholder="Detalle del sub-pasoâ€¦">${ss.detail||''}</textarea>`;
    const taSub = subDetail.querySelector('textarea');
    taSub.title = ss.detail || '';
    if(typeof autoResize === 'function'){ autoResize(taSub); }
    taSub.oninput = e=>{
      ss.detail = e.target.value;
      taSub.title = ss.detail || '';
      if(typeof autoResize === 'function'){ autoResize(taSub); }
      save();
    };

    const attachWrapSub=document.createElement('div');
    attachWrapSub.className='step-attachments';

    if(ss.links.length){
      const linksDiv=document.createElement('div');
      linksDiv.className='step-links';
      const label=document.createElement('span');
      label.className='label';
      label.textContent='Enlaces:';
      linksDiv.appendChild(label);
      ss.links.forEach((url,i)=>{
        const item=document.createElement('span');
        item.className='attach-chip';
        const a=document.createElement('a');
        a.href=url;
        a.target='_blank';
        a.rel='noopener noreferrer';
        a.textContent=`${i+1}`;
        a.title=url;
        item.appendChild(a);
        const del=document.createElement('button');
        del.type='button';
        del.className='mini mini-attach-del';
        del.textContent='âˆ’';
        del.setAttribute('data-act','attach-del');
        del.dataset.kind='link';
        del.dataset.index=String(i);
        item.appendChild(del);
        linksDiv.appendChild(item);
      });
      attachWrapSub.appendChild(linksDiv);
    }

    if(ss.docs.length){
      const docsDiv=document.createElement('div');
      docsDiv.className='step-docs';
      const label=document.createElement('span');
      label.className='label';
      label.textContent='Docs:';
      docsDiv.appendChild(label);
      ss.docs.forEach((doc,i)=>{
        const item=document.createElement('span');
        item.className='attach-chip';
        let el=document.createElement('a');
        let href;
        let label;
        if(typeof doc==='string'){
          href = doc;
          label = doc;
        }else if(doc && doc.data){
          href = doc.data;
          label = doc.name || ('Doc '+(i+1));
        }
        if(href){
          el.href = href;
          el.target = '_blank';
          el.rel = 'noopener noreferrer';
          el.textContent = label || ('Doc '+(i+1));
          item.appendChild(el);
        }
        const del=document.createElement('button');
        del.type='button';
        del.className='mini mini-attach-del';
        del.textContent='âˆ’';
        del.setAttribute('data-act','attach-del');
        del.dataset.kind='doc';
        del.dataset.index=String(i);
        item.appendChild(del);
        docsDiv.appendChild(item);
      });
      attachWrapSub.appendChild(docsDiv);
    }

    if(attachWrapSub.childNodes.length){
      subDetail.appendChild(attachWrapSub);

      // manejadores de borrado de adjuntos (sub-paso)
      attachWrapSub.querySelectorAll('button[data-act="attach-del"]').forEach(btn=>{
        btn.onclick = (ev)=>{
          ev.stopPropagation();
          const kind = btn.dataset.kind;
          const idx  = parseInt(btn.dataset.index||'-1',10);
          if(Number.isNaN(idx)) return;
          if(kind==='link'){
            ss.links.splice(idx,1);
          }else if(kind==='doc'){
            ss.docs.splice(idx,1);
          }
          save();
          if(typeof renderModules==='function') renderModules();
        };
      });
    }

    const miniMenuSub = sCard.querySelector('[data-act="menu-toggle"]');
    const btnDelSub   = sCard.querySelector('[data-act="sub-delete"]');
    const btnAttachSub = sCard.querySelector('[data-act="sub-attach"]');
    if(btnAttachSub){
      if(!(ss.links.length || ss.docs.length)){
        btnAttachSub.style.display='none';
      }else{
        btnAttachSub.style.display='';
        const totalAdjSub = (Array.isArray(ss.links)?ss.links.length:0) + (Array.isArray(ss.docs)?ss.docs.length:0);
        // Mano protagonista + nÃºmero pequeÃ±o en sub-pasos (â˜3)
        if(totalAdjSub>0){
          btnAttachSub.innerHTML = 'â˜<span class="mini-count">'+String(totalAdjSub)+'</span>';
        }else{
          btnAttachSub.textContent = 'ğŸ‘‡';
        }
        btnAttachSub.onclick = (ev)=>{
          ev.stopPropagation();
          if(!ss.links.length && !ss.docs.length){
            if(window.paToastFn) window.paToastFn('Este sub-paso no tiene adjuntos.');
            return;
          }

          const items = [];
          if(Array.isArray(ss.links)){
            ss.links.forEach((url,i)=>{
              if(!url) return;
              items.push({
                label:'Enlace '+(i+1),
                url:String(url)
              });
            });
          }
          if(Array.isArray(ss.docs)){
            ss.docs.forEach((doc,i)=>{
              if(!doc) return;
              if(typeof doc==='string'){
                items.push({
                  label:doc,
                  url:String(doc)
                });
              }else if(doc.data){
                items.push({
                  label:doc.name || ('Doc '+(i+1)),
                  url:String(doc.data)
                });
              }
            });
          }

          if(!items.length){
            if(window.paToastFn) window.paToastFn('Este sub-paso no tiene adjuntos vÃ¡lidos.');
            return;
          }

          const openUrl = (url)=>{
            if(!url) return;
            try{
              window.open(url,'_blank','noopener');
            }catch(e){}
          };

          if(items.length===1){
            openUrl(items[0].url);
            return;
          }

          const msg = 'Selecciona el documento que quieres abrir:\n\n' +
            items.map((it,idx)=> (idx+1)+'. '+it.label).join('\n');
          const ans = prompt(msg,'1');
          if(!ans) return;
          const idx = parseInt(ans,10);
          if(isNaN(idx) || idx<1 || idx>items.length) return;
          openUrl(items[idx-1].url);
        };
      }
    }


    function doFlagSub(){
      openProcPicker(pid=>{ ss.link={pid}; save(); renderModules(); });
    }
    function doDetailSub(){
      ss._openDetailStep = !ss._openDetailStep;
      save();
      renderModules();
    }
    function doDeleteSub(){
      const idxSub = st.subSteps.indexOf(ss);
      if(idxSub>-1){
        st.subSteps.splice(idxSub,1);
        save();
        renderModules();
      }
    }

    miniMenuSub.onclick=(ev)=>{
      ev.stopPropagation();
      menuSub.classList.toggle('hide');
    };

    if(btnDelSub){
      btnDelSub.onclick = (ev)=>{
        ev.stopPropagation();
        if(confirm('Â¿Eliminar sub-paso?')) doDeleteSub();
      };
    }

    const menuFlagSub   = menuSub.querySelector('[data-act="menu-flag"]');
    const menuDetailSub = menuSub.querySelector('[data-act="menu-detail"]');
    const menuDeleteSub = menuSub.querySelector('[data-act="menu-delete"]');
    const menuLinkSub   = menuSub.querySelector('[data-act="menu-link"]');
    const menuDocSub    = menuSub.querySelector('[data-act="menu-doc"]');

    menuFlagSub.onclick = ()=>{ doFlagSub(); menuSub.classList.add('hide'); };
    menuDetailSub.onclick = ()=>{ doDetailSub(); menuSub.classList.add('hide'); };
    menuDeleteSub.onclick = ()=>{ if(confirm('Â¿Eliminar sub-paso?')) doDeleteSub(); menuSub.classList.add('hide'); };
    menuLinkSub.onclick=()=>{
      const url = prompt('Enlace a adjuntar (URL o referencia):', '');
      if(url){
        ss.links.push(url);
        miniMenuSub.title = `Opciones de sub-paso (enlaces: ${ss.links.length}, docs: ${ss.docs.length})`;
        save();
        if(typeof renderModules==='function') renderModules();
      }
      menuSub.classList.add('hide');
    };
    menuDocSub.onclick=()=>{
      pendingDocTarget = ss;
      const fp=document.getElementById('paFilePicker');
      if(fp){
        fp.value='';
        fp.click();
      }
      menuSub.classList.add('hide');
    };

    if(ss.links.length || ss.docs.length){
      miniMenuSub.title = `Opciones de sub-paso (enlaces: ${ss.links.length}, docs: ${ss.docs.length})`;
    }

    if(ss.link?.pid){
      const dest=currentProcesses().find(x=>x.id===ss.link.pid);
      if(dest){
        const chip=document.createElement('div');
        chip.className='chip';
        chip.style.background=dest.color;
        chip.style.margin='3px 0 0 48px';
        chip.style.cursor='pointer';
        chip.innerHTML=`â†’ <small>Ir al proceso:</small> <strong>${dest.name}</strong>`;

        chip.onclick=(ev)=>{
          if(dest && dest.id){
            activePid = dest.id;
            save();
            render();
            const procEl=document.querySelector('.proc-item[data-pid="'+dest.id+'"]');
            if(procEl){
              procEl.scrollIntoView({behavior:'smooth',block:'nearest'});
            }
          }
        };

        sCard.appendChild(chip);
      }
    }

    sCard.appendChild(subDetail);
    sRow.appendChild(sCard);
    return sRow;
  }

  if(Array.isArray(st.subSteps) && st.subSteps.length){
    st.subSteps.forEach((ss, sIndex)=>{
      row.appendChild(renderSubStep(ss, sIndex));
    });
  }

  if(!Array.isArray(st.yes)) st.yes=[];
  if(!Array.isArray(st.no))  st.no=[];

  const yesHas = (st.yes && st.yes.length>0) || (st.yesLink && st.yesLink.pid);
  const noHas  = (st.no  && st.no.length>0)  || (st.noLink  && st.noLink.pid);
  const hasAny = yesHas || noHas;

  const locked = sessionStorage.getItem('PA_PIN_OK')!=='1';

  const branchesWrapper=document.createElement('div');
  branchesWrapper.className='branches';
  const branchesInner=document.createElement('div');
  branchesInner.className='branches-inner';

  if((locked && hasAny) || st._editingBranches){
    if(st._editingBranches && !locked){
      const collapse = document.createElement('div');
      collapse.className='branch-collapse';
      collapse.innerHTML='<span>ver menos</span><span>â–²</span>';
      collapse.onclick=()=>{
        st._editingBranches=false;
        st._openBranches=false;
        save();
        renderModules();
      };
      branchesWrapper.appendChild(collapse);
    }

    branchesInner.appendChild(branchBox(p,m,st,'no',index));
    branchesInner.appendChild(branchBox(p,m,st,'yes',index));
    branchesWrapper.appendChild(branchesInner);
    row.appendChild(branchesWrapper);
  }else if(hasAny){
    const indicator = document.createElement('div');
    indicator.className='branch-indicator';
    indicator.innerHTML='<span>ver mÃ¡s</span><span>ğŸ‘‡</span>';
    indicator.onclick=()=>{
      st._editingBranches=true;
      st._openBranches=true;
      save();
      renderModules();
    };
    row.appendChild(indicator);
  }

  return row;
}


/* ===== Subprocesos ===== */
function modCard(p,m){
  const card=document.createElement('div');
  card.className='module';
  if(m.isSub) card.classList.add('module-subchild');
  card.style.setProperty('--proc',p.color);
  card.dataset.mid = m.id;
  card.dataset.pid = p.id;

  const head=document.createElement('div'); head.className='mod-head';
  head.style.setProperty('--proc',p.color);
  head.innerHTML=`<input class="mod-title" value="${m.title}">
    <select class="sel">${responsablesForDept().map(r=>`<option ${m.responsable===r?'selected':''}>${r}</option>`).join('')}</select>
    <input class="resp-extra" placeholder="Nombre otrosâ€¦" value="${m.respOtro||''}" style="${m.responsable==='Otros'?'display:inline-block':'display:none'}">
    <button class="pill" data-act="toggle-detail" aria-expanded="${m._openDetail?'true':'false'}">â–¾ Detalle</button>
    <button class="pill" data-act="toggle-steps" aria-expanded="${m._openSteps===false?'false':'true'}">â–¾ Pasos</button>
    <button class="pill" data-act="add-submodule">+ Sub/subproceso</button>
    <button class="pill" data-act="add-step">+ Paso</button>
    <button class="pill" data-act="close">${m.completed?'ğŸ¯ Cerrado':'ğŸ¯ Guardar'}</button>
    <button class="pill" data-act="del">â€“</button>`;
  const titleEl=head.querySelector('.mod-title');
  titleEl.oninput=e=>{ m.title=e.target.value; titleEl.title=m.title||''; save(); };
  titleEl.title = m.title || '';
  titleEl.ondblclick=()=>{ m._openDetail=!m._openDetail; toggleBlock(det,m._openDetail); if(m._openDetail){ setTimeout(()=>det.querySelector('textarea').focus(),0);} save(); };

  const selEl=head.querySelector('select');
  const respExtra=head.querySelector('.resp-extra');
  selEl.onchange=e=>{
    m.responsable=e.target.value;
    if(m.responsable==='Otros'){
      respExtra.style.display='inline-block';
    }else{
      respExtra.style.display='none';
    }
    save();
  };
  respExtra.oninput=e=>{
    m.respOtro=e.target.value;
    save();
  };

  // Campo editable de Rol al lado del selector
  const roleDesc=document.createElement('div');
  roleDesc.className='role-desc';
  if(respExtra){
    respExtra.insertAdjacentElement('afterend', roleDesc);
  }else if(selEl){
    selEl.insertAdjacentElement('afterend', roleDesc);
  }
  const roleLabel=document.createElement('span');
  roleLabel.textContent='Rol:';
  const roleInput=document.createElement('input');
  roleInput.type='text';
  roleInput.className='role-input';
  roleInput.value = m.rolTexto || '';
  const roleHint=document.createElement('span');
  roleHint.className='role-hint';
  roleDesc.appendChild(roleLabel);
  roleDesc.appendChild(roleInput);
  roleDesc.appendChild(roleHint);
  function updateRoleDesc(){
    const rol = m.responsable || (selEl && selEl.value) || 'AudiÃ³logo';
    const hint = ROL_DESC[rol] || '';
    roleHint.textContent = hint || '';
    // En modo lectura el PIN pondrÃ¡ readonly al input, pero el texto y la descripciÃ³n siguen totalmente visibles.
  }
  updateRoleDesc();
  roleInput.oninput = (e)=>{
    m.rolTexto = e.target.value;
    save();
  };
  if(selEl) selEl.addEventListener('change', updateRoleDesc);
  if(respExtra) respExtra.addEventListener('input', updateRoleDesc);

  head.querySelector('[data-act="add-step"]').onclick=()=>{
    m.steps.push(makeStep());
    m._openSteps = true;
    save();
    renderModules();
  };

  head.querySelector('[data-act="toggle-detail"]').onclick=(ev)=>{
    m._openDetail=!m._openDetail;
    ev.currentTarget.setAttribute('aria-expanded', m._openDetail?'true':'false');
    toggleBlock(det,m._openDetail);
    if(m._openDetail){ setTimeout(()=>det.querySelector('textarea').focus(),0); }
    save();
  };
  head.querySelector('[data-act="close"]').onclick=()=>{ m.completed=!m.completed; save(); renderModules(); };

  head.querySelector('[data-act="del"]').onclick=()=>{
    if(confirm('Â¿Eliminar subproceso, sus pasos y sub-subprocesos?')){
      const dept=currentDept(); if(!dept) return;
      const idToRemove = m.id;
      dept.processes.forEach(proc=>{
        if(!Array.isArray(proc.modules)) return;
        proc.modules = proc.modules.filter(mod=>mod.id!==idToRemove && mod.parentId!==idToRemove);
      });
      save();
      renderModules();
    }
  };

  const btnSub = head.querySelector('[data-act="add-submodule"]');
  if(btnSub){
    if(m.isSub){
      btnSub.style.display='none'; /* solo en subproceso principal */
    }else{
      btnSub.onclick=()=>{
        const dept=currentDept(); if(!dept) return;
        const proc = dept.processes.find(x=>x.id===p.id); if(!proc) return;
        if(!Array.isArray(proc.modules)) proc.modules=[];
        const idx = proc.modules.findIndex(x=>x.id===m.id);
        const subModule = {
          id:uid(),
          title: (m.title || 'Subproceso') + ' - Sub',
          responsable: m.responsable || RESPONSABLES[0],
          respOtro: m.respOtro || '',
          detail:'',
          steps:[makeStep()],
          completed:false,
          _openDetail:false,
          _openSteps:true,
          isSub:true,
          parentId:m.id
        };
        if(idx>-1){
          proc.modules.splice(idx+1,0,subModule);
        }else{
          proc.modules.push(subModule);
        }
        save();
        renderModules();
      };
    }
  }

  card.appendChild(head);

  const det=document.createElement('div');
  det.className='mod-detail'+(m._openDetail?'':' hide');
  det.setAttribute('aria-hidden', m._openDetail ? 'false':'true');
  det.innerHTML=`<textarea placeholder="DescripciÃ³n del subprocesoâ€¦">${m.detail||''}</textarea>`;
  const mta=det.querySelector('textarea');
  mta.title = m.detail || '';
  mta.oninput=e=>{ m.detail=e.target.value; mta.title=m.detail||''; save(); };
  card.appendChild(det);

  const steps=document.createElement('div'); steps.className='steps';
  steps.style.setProperty('--proc',p.color);
  m.steps.forEach((st,idx)=>{
    if(typeof st.detail === 'undefined') st.detail='';
    if(typeof st._openDetailStep === 'undefined') st._openDetailStep=false;
    if(typeof st._openBranches === 'undefined') st._openBranches=false;
    if(typeof st._editingBranches === 'undefined') st._editingBranches=false;
    if(!Array.isArray(st.yes)) st.yes=[];
    if(!Array.isArray(st.no))  st.no=[];
    if(!Array.isArray(st.links)) st.links=[];
    if(!Array.isArray(st.docs))  st.docs=[];
    steps.appendChild(stepRow(p,m,st,idx));
  });
  card.appendChild(steps);

  if(m._openSteps === false){
    hideBlock(steps);
  }else{
    showBlock(steps);
  }
  const btnSteps = head.querySelector('[data-act="toggle-steps"]');
  if(btnSteps){
    btnSteps.setAttribute('aria-expanded', m._openSteps===false?'false':'true');
    btnSteps.onclick=(ev)=>{
      const current = (m._openSteps === false) ? false : true;
      const next = !current;
      m._openSteps = next;
      btnSteps.setAttribute('aria-expanded', next ? 'true' : 'false');
      toggleBlock(steps, next);
      save();
      requestAnimationFrame(()=>{ layoutAllSteps(); drawAllFlows(); });
    };
  }

  if(m.completed){
    const d=document.createElement('span'); d.className='badge-diana'; d.textContent='ğŸ¯';
    head.appendChild(d);
  }
  return card;
}

/* ===== Render derecha ===== */
function renderModules(){
  const box=document.getElementById('modules'); if(!box) return;
  box.innerHTML='';
  const dept=currentDept(); if(!dept) return;
  if(!Array.isArray(dept.processes)) dept.processes=[];
  let p=findProcessById(activePid) || dept.processes[0];
  if(!p){ activePid=null; return; }
  activePid=p.id;
  if(!Array.isArray(p.modules)) p.modules=[];
  p.modules.forEach(m=> box.appendChild(modCard(p,m)));

  requestAnimationFrame(()=>{ layoutAllSteps(); drawAllFlows(); });
}

/* ===== Acciones globales ===== */
function createModuleForProcess(pid,titleOverride){
  const dept=currentDept(); if(!dept) return null;
  if(!Array.isArray(dept.processes)) dept.processes=[];
  const p=dept.processes.find(x=>x.id===pid); if(!p) return null;
  if(!Array.isArray(p.modules)) p.modules=[];
  const defaultTitle = titleOverride || (p.name ? `${p.name} - Pasos` : 'Nuevo subproceso');
  const respList = responsablesForDept();
  const m={
    id:uid(),
    title:defaultTitle,
    responsable:(respList && respList[0]) || 'AudiÃ³logo',
    respOtro:'',
    detail:'',
    steps:[makeStep()],
    completed:false,
    _openDetail:false,
    _openSteps:true
  };
  p.modules.push(m); save(); renderModules(); return m;
}
function addProcess(){
  const dept=currentDept();
  if(!dept){
    alert('Primero crea un departamento con "Departamentos+"');
    return;
  }
  if(!Array.isArray(dept.processes)) dept.processes=[];
  const color=colors[dept.processes.length%colors.length];
  const p={id:uid(),name:'Nuevo proceso',color,detail:'',modules:[],_openDetail:false};
  dept.processes.push(p); activePid=p.id; save(); render();
}
function addStepGlobal(){
  const dept=currentDept();
  if(!dept){ alert('Crea un departamento y un proceso'); return; }
  if(!Array.isArray(dept.processes) || !dept.processes.length){ alert('Primero crea un proceso'); return; }
  let p=findProcessById(activePid) || dept.processes[dept.processes.length-1];
  if(!p){ p=dept.processes[0]; }
  if(!p) return;
  if(!Array.isArray(p.modules) || !p.modules.length){
    createModuleForProcess(p.id, `${p.name} - Pasos`);
  }
  let m=p.modules[p.modules.length-1];
  if(!m) m=createModuleForProcess(p.id, `${p.name} - Pasos`);
  m.steps.push(makeStep());
  m._openSteps = true;
  save();
  renderModules();
}
function addDept(){
  const name=prompt('Nombre del nuevo departamento:','');
  if(!name) return;
  const dId=uid();
  state.departments.push({
    id:dId,
    name:name,
    description:'',
    _openDesc:false,
    processes:[]
  });
  state.activeDeptId=dId;
  activePid=null;
  save();
  render();
}

/* ===== Render maestro ===== */
function render(){
  renderDeptSelect();
  renderDeptInfo();
  renderProcesses();
  renderModules();
  if (window.applyPinLockUI) window.applyPinLockUI();
}

/* ===== Boot ===== */
load(); document.getElementById('stamp').textContent='Ãšltima actualizaciÃ³n '+stamp();
window.applyPinLockUI = window.applyPinLockUI || function(){}; 
render();

document.getElementById('btnAddProcess').onclick=addProcess;
document.getElementById('btnAddSubprocPaso').onclick=()=>{
  const dept=currentDept();
  if(!dept){alert('Crea un departamento y un proceso');return;}
  if(!Array.isArray(dept.processes) || !dept.processes.length){alert('Crea un proceso');return;}
  const p=findProcessById(activePid) || dept.processes[0];
  if(!p){alert('Crea un proceso');return;}
  createModuleForProcess(p.id,'Nuevo subproceso');
};
document.getElementById('btnAddStepGlobal').onclick=addStepGlobal;
function saveAll(){
  save();
  if(window.betterDownloadHTML){
    try{ window.betterDownloadHTML(); }catch(e){ console.error(e); }
  }
}
document.getElementById('btnSave').onclick=saveAll;

const deptSelectEl=document.getElementById('deptSelect');
if(deptSelectEl){
  deptSelectEl.addEventListener('change',e=>handleDeptChange(e.target.value));
}
const btnDeptAdd=document.getElementById('btnDeptAdd');
if(btnDeptAdd){
  btnDeptAdd.addEventListener('click',addDept);
}

window.addEventListener('resize',()=>requestAnimationFrame(()=>{layoutAllSteps();drawAllFlows();}));

/* ===== Buscador ===== */
function stepMatches(st, q){
  if(!q) return true;
  const ql = q.toLowerCase();
  if((st.title||'').toLowerCase().includes(ql)) return true;
  if((st.detail||'').toLowerCase().includes(ql)) return true;

  const checkPoints = (list=[])=>{
    for(const pt of list){
      if((pt.text||'').toLowerCase().includes(ql)) return true;
      if(Array.isArray(pt.children)){
        for(const ch of pt.children){
          if((ch.text||'').toLowerCase().includes(ql)) return true;
        }
      }
    }
    return false;
  };

  if(checkPoints(st.yes||[])) return true;
  if(checkPoints(st.no||[])) return true;
  return false;
}
function moduleMatches(m, q){
  if(!q) return true;
  const ql = q.toLowerCase();
  if((m.title||'').toLowerCase().includes(ql)) return true;
  if((m.detail||'').toLowerCase().includes(ql)) return true;
  if(Array.isArray(m.steps)){
    for(const st of m.steps){
      if(stepMatches(st, ql)) return true;
    }
  }
  return false;
}
function processMatches(p, q){
  if(!q) return true;
  const ql = q.toLowerCase();
  if((p.name||'').toLowerCase().includes(ql)) return true;
  if((p.detail||'').toLowerCase().includes(ql)) return true;
  if(Array.isArray(p.modules)){
    for(const m of p.modules){
      if(moduleMatches(m, ql)) return true;
    }
  }
  return false;
}

document.getElementById('q').addEventListener('input',e=>{
  const q = e.target.value.trim().toLowerCase();

  const dept=currentDept();
  if(!dept) return;
  if(!Array.isArray(dept.processes)) dept.processes=[];

  document.querySelectorAll('.proc-item').forEach(el=>{
    const pid = el.dataset.pid;
    const p = dept.processes.find(x=>x.id===pid);
    const visible = !q || (p && processMatches(p, q));
    el.classList.toggle('hide', !visible);
  });

  const pActive = findProcessById(activePid) || dept.processes[0];
  if(!pActive) return;

  document.querySelectorAll('#modules .module').forEach(el=>{
    const mid = el.dataset.mid;
    const m = (pActive.modules||[]).find(x=>x.id===mid);
    const visible = !q || (m && moduleMatches(m, q));
    el.classList.toggle('hide', !visible);
  });
});

/* ===== File picker docs ===== */
const filePicker = document.getElementById('paFilePicker');
if(filePicker){
  filePicker.addEventListener('change', e=>{
    if(!pendingDocTarget) return;
    const files = Array.from(e.target.files || []);
    if(!files.length) return;

    if(!pendingDocTarget.docs) pendingDocTarget.docs=[];
    let pending = files.length;

    files.forEach(f=>{
      const reader = new FileReader();
      reader.onload = ev=>{
        try{
          pendingDocTarget.docs.push({
            name: f.name,
            type: f.type || 'application/octet-stream',
            data: ev.target.result
          });
        }catch(_e){}
        pending--;
        if(pending===0){
          pendingDocTarget=null;
          save();
          if(typeof renderModules==='function') renderModules();
        }
      };
      reader.onerror = ()=>{
        pending--;
        if(pending===0){
          pendingDocTarget=null;
          save();
          if(typeof renderModules==='function') renderModules();
        }
      };
      reader.readAsDataURL(f);
    });
  });
}

/* =======================================================================
   UTILIDADES (PIN, PDF, HTML, NUBE)
   ======================================================================= */
(function(){
  const PIN_CODE = 'AR4321';
  const SNAP_KEY = 'PA_SNAPSHOT_V1';

  const toast = (() => {
    const n = document.createElement('div');
    n.className='pa-toast'; n.id='paToast';
    document.body.appendChild(n);
    const fn = (msg)=>{ n.textContent=msg; n.classList.add('show'); setTimeout(()=>n.classList.remove('show'),2200); };
    window.paToastFn = fn;
    return fn;
  })();

  const fileStamp = () => { const d=new Date(),p=n=>String(n).padStart(2,'0'); return `${d.getFullYear()}-${p(d.getMonth()+1)}-${p(d.getDate())}_${p(d.getHours())}-${p(d.getMinutes())}`; };

  const pinBtn  = document.getElementById('paPinBtn');
  const pdfBtn  = document.getElementById('paPdfBtn');
  const htmlBtn = document.getElementById('paHtmlBtn');
  const saveBtn = document.getElementById('paSaveCloud');

  if(saveBtn){
    saveBtn.addEventListener('click', function(){
      if(window.betterDownloadHTML){
        try{ window.betterDownloadHTML(); }catch(e){ console.error(e); }
      }
    });
  }

  window.applyPinLockUI = function applyPinLockUI(){
    const locked = sessionStorage.getItem('PA_PIN_OK')!=='1';
    document.body.classList.toggle('pa-locked', locked);

    ['#btnAddProcess','#btnAddStepGlobal','#btnAddSubprocPaso','#btnDeptAdd'].forEach(sel=>{
      const b=document.querySelector(sel);
      if(b){
        b.classList.toggle('lock-block', locked);
        b.toggleAttribute('disabled', locked);
      }
    });

    document.querySelectorAll('.proc-item .icon-btn[title="Renombrar"], .proc-item .icon-btn[title="Eliminar"]').forEach(b=>{
      b.classList.toggle('lock-block', locked);
      b.toggleAttribute('disabled', locked);
    });

    // campos de texto en solo lectura, pero clicables (se pueden seleccionar / copiar)
    document.querySelectorAll('.title, textarea, .pt-input, .role-input').forEach(el=>{
      el.toggleAttribute('readonly', locked);
      el.classList.toggle('is-readonly', locked);
    });
    // el tÃ­tulo del mÃ³dulo (barra negra) se deja visualmente igual, solo se bloquea la ediciÃ³n
    document.querySelectorAll('.mod-title').forEach(el=>{
      el.toggleAttribute('readonly', locked);
    });

    // sÃ³lo se bloquean los select de responsable; el selector de departamento SI se puede usar
    document.querySelectorAll('select.sel').forEach(s=>{
      s.toggleAttribute('disabled', locked);
      s.classList.toggle('is-readonly', locked);
    });

    document.querySelectorAll('[data-act="add-step"], [data-act="close"], [data-act="del"], [data-act="add-submodule"], [data-act="step-extra"], [data-act="step-del"], [data-act="sub-delete"], [data-act="menu-delete"], [data-act="menu-link"], [data-act="menu-doc"], [data-act="menu-flag"], [data-act="menu-branches"], [data-act="attach-del"]').forEach(b=>{
      b.classList.toggle('lock-block', locked);
      b.toggleAttribute('disabled', locked);
    });

    document.querySelectorAll('.branch .p-mini').forEach(b=>{
      b.classList.toggle('lock-block', locked);
      b.toggleAttribute('disabled', locked);
    });
  };


  // BLOQUEO SÃ“LO PARA AÃ‘ADIR / BORRAR / EDITAR
  function cancelIfLocked(e){
    const locked = sessionStorage.getItem('PA_PIN_OK')!=='1';
    if(!locked) return;
    const t = e.target.closest('button, textarea, select, .title, .mod-title, .pt-input');
    if(!t) return;

    // SÃ³lo bloqueamos acciones de EDICIÃ“N, BORRADO o AÃ‘ADIDO
    if(
      t.matches('#btnAddProcess, #btnAddStepGlobal, #btnAddSubprocPaso, #btnDeptAdd') ||
      t.matches('.proc-item .icon-btn[title="Renombrar"], .proc-item .icon-btn[title="Eliminar"]') ||
      t.matches('[data-act="add-step"], [data-act="close"], [data-act="del"], [data-act="add-submodule"], [data-act="step-extra"], [data-act="step-del"], [data-act="sub-delete"], [data-act="menu-delete"], [data-act="menu-link"], [data-act="menu-doc"], [data-act="menu-flag"], [data-act="menu-branches"], [data-act="attach-del"]') ||
      t.matches('.branch .p-mini') ||
      t.matches('.dept-edit-menu button[data-act="edit"], .dept-edit-menu button[data-act="delete"]')
    ){
      e.stopPropagation();
      e.preventDefault();
      toast('Modo lectura: bloqueado por PIN');
    }
    // Se permiten: desplegar/plegar, ver detalle, cambiar departamento, hacer scroll y seleccionar texto.
  }
  document.addEventListener('click', cancelIfLocked, true);
  document.addEventListener('input', cancelIfLocked, true);
  document.addEventListener('change', cancelIfLocked, true);

  const mo = new MutationObserver(()=>applyPinLockUI());
  mo.observe(document.body,{childList:true,subtree:true});

  function printAll(){
    const opened=[];
    document.querySelectorAll('.proc-detail, .mod-detail, .branches, .step-detail, .dept-desc, details').forEach(b=>{
      const wasHidden = (b.classList && (b.classList.contains('hide') || b.style.display==='none')) || (b.tagName==='DETAILS' && !b.open);
      if(wasHidden){
        if(b.tagName==='DETAILS') b.open=true; else showBlock(b);
        opened.push(b);
      }
    });
    const restore=()=>{ opened.forEach(h=>{ if(h.tagName==='DETAILS') h.open=false; else hideBlock(h); }); window.removeEventListener('afterprint',restore); };
    window.addEventListener('afterprint',restore);
    window.print();
  }

  function currentHTML(){
    // Insertamos un snapshot del estado en un <script id="paSnapshot" type="application/json">
    let snapEl=document.getElementById('paSnapshot');
    let added=false;
    if(!snapEl){
      snapEl=document.createElement('script');
      snapEl.id='paSnapshot';
      snapEl.type='application/json';
      added=true;
    }
    try{
      snapEl.textContent = JSON.stringify(state);
    }catch(e){
      // si algo falla, seguimos sin snapshot
    }
    if(added){
      document.body.appendChild(snapEl);
    }

    const clone=document.documentElement.cloneNode(true);
    // limpiamos el toast de avisos
    clone.querySelectorAll('#paToast').forEach(el=>el?.parentNode?.removeChild(el));

    // quitamos el snapshot temporal del DOM original
    if(added && snapEl.parentNode){
      snapEl.parentNode.removeChild(snapEl);
    }

    return '<!DOCTYPE html>\n'+clone.outerHTML;
  }

  function downloadHTML(){
    const blob = new Blob([currentHTML()],{type:'text/html'});
    const a=document.createElement('a');
    a.href=URL.createObjectURL(blob);
    a.download=`PROCESOS-AUDIO_${fileStamp()}.html`;
    document.body.appendChild(a); a.click(); a.remove();
  }

  function saveToCloud(){
    try{
      localStorage.setItem(SNAP_KEY, JSON.stringify({when:Date.now(), html: currentHTML()}));
      toast('Guardado en nube (local)');
    }catch(e){ console.error(e); toast('No se pudo guardar'); }
  }

  function togglePin(){
    if(sessionStorage.getItem('PA_PIN_OK')==='1'){
      sessionStorage.removeItem('PA_PIN_OK');
      pinBtn.classList.remove('locked');
      applyPinLockUI();
      toast('EdiciÃ³n bloqueada (vista lectura)');
    }else{
      const v=prompt('Introduce PIN para editar:');
      if(v===PIN_CODE){ sessionStorage.setItem('PA_PIN_OK','1'); pinBtn.classList.add('locked'); applyPinLockUI(); toast('EdiciÃ³n habilitada'); }
      else if(v!==null){ toast('PIN incorrecto'); }
    }
  }

  pinBtn?.addEventListener('click', togglePin);
  pdfBtn?.addEventListener('click',  printAll);
  htmlBtn?.addEventListener('click', downloadHTML);
  saveBtn?.addEventListener('click', saveToCloud);

  if(sessionStorage.getItem('PA_PIN_OK')!=='1'){ applyPinLockUI(); }
})();
</script>



<script>
document.getElementById('paPdfBtn').onclick = function() {
  const choice = confirm('Â¿Imprimir/Guardar este departamento o todos?\n\nPulsa Aceptar para ESTE DEPARTAMENTO o Cancelar para TODOS.');
  if (choice) {
    window.print();
  } else {
    // Simular impresiÃ³n de todos (por simplicidad, se imprimen todos)
    window.print();
  }
};
</script>
<script id="paSnapshot" type="application/json">{"departments":[{"id":"plgt0900","name":"AUDIO","description":"","_openDesc":false,"processes":[{"id":"pvnfkpn8","name":"Nuevo proceso","color":"#bde0fe","detail":"","modules":[{"id":"pq1ynmh3","title":"Nuevo proceso - Pasos","responsable":"AudiÃ³logo","respOtro":"","detail":"","steps":[{"id":"p67vs1dw","title":"Nuevo paso","detail":"","link":null,"links":[],"docs":[],"yes":[],"no":[],"yesLink":null,"noLink":null,"_openBranches":false,"_editingBranches":false,"_openDetailStep":false},{"id":"pgjho7z9","title":"Nuevo paso","detail":"","link":null,"links":[],"docs":[],"yes":[],"no":[],"yesLink":null,"noLink":null,"_openBranches":false,"_editingBranches":false,"_openDetailStep":false},{"id":"pt74js13","title":"Nuevo paso","detail":"","link":null,"links":[],"docs":[],"yes":[],"no":[],"yesLink":null,"noLink":null,"_openBranches":false,"_editingBranches":false,"_openDetailStep":false},{"id":"pvbp4gsw","title":"Nuevo paso","detail":"","link":null,"links":[],"docs":[],"yes":[],"no":[],"yesLink":null,"noLink":null,"_openBranches":false,"_editingBranches":false,"_openDetailStep":false},{"id":"pljgblwx","title":"Nuevo paso","detail":"","link":null,"links":[],"docs":[],"yes":[],"no":[],"yesLink":null,"noLink":null,"_openBranches":false,"_editingBranches":false,"_openDetailStep":false},{"id":"p1w3tlzw","title":"Nuevo paso","detail":"","link":null,"links":[],"docs":[],"yes":[],"no":[],"yesLink":null,"noLink":null,"_openBranches":false,"_editingBranches":false,"_openDetailStep":false},{"id":"psf74ied","title":"Nuevo paso","detail":"","link":null,"links":[],"docs":[{"name":"ANAMNES HACE-MOTIVO DE VISITA.docx","type":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","data":"data:application/vnd.openxmlformats-officedocument.wordprocessingml.document;base64,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"}],"yes":[],"no":[],"yesLink":null,"noLink":null,"_openBranches":false,"_editingBranches":false,"_openDetailStep":false},{"id":"pt7j6v20","title":"Nuevo paso","detail":"","link":null,"links":[],"docs":[],"yes":[],"no":[],"yesLink":null,"noLink":null,"_openBranches":false,"_editingBranches":false,"_openDetailStep":false},{"id":"p40jcozu","title":"Nuevo paso","detail":"","link":null,"links":[],"docs":[],"yes":[],"no":[],"yesLink":null,"noLink":null,"_openBranches":false,"_editingBranches":false,"_openDetailStep":false},{"id":"pi9dida2","title":"Nuevo paso","detail":"","link":null,"links":[],"docs":[],"yes":[],"no":[],"yesLink":null,"noLink":null,"_openBranches":false,"_editingBranches":false,"_openDetailStep":false},{"id":"pv89otu0","title":"Nuevo paso","detail":"","link":null,"links":[],"docs":[],"yes":[],"no":[],"yesLink":null,"noLink":null,"_openBranches":false,"_editingBranches":false,"_openDetailStep":false}],"completed":false,"_openDetail":false,"_openSteps":true}],"_openDetail":false},{"id":"p92lfzvx","name":"Nuevo proceso","color":"#caffbf","detail":"","modules":[],"_openDetail":false},{"id":"prb7yd58","name":"Nuevo proceso","color":"#ffadad","detail":"","modules":[],"_openDetail":false},{"id":"pqc0pkx0","name":"Nuevo proceso","color":"#fdffb6","detail":"","modules":[],"_openDetail":false},{"id":"ptabg9bj","name":"Nuevo proceso","color":"#bdb2ff","detail":"","modules":[],"_openDetail":false},{"id":"pauwompt","name":"Nuevo proceso","color":"#bdb2ff","detail":"","modules":[],"_openDetail":false},{"id":"pl2wz4vz","name":"Nuevo proceso","color":"#ffc6ff","detail":"","modules":[],"_openDetail":false},{"id":"p5f60ohf","name":"Nuevo proceso","color":"#a0e7e5","detail":"","modules":[],"_openDetail":false},{"id":"phip02e7","name":"Nuevo proceso","color":"#c7f9cc","detail":"","modules":[],"_openDetail":false}]}],"activeDeptId":"plgt0900"}</script>
<script>
(function(){
  function pad(n){ return String(n).padStart(2,'0'); }
  function fileStampOverride(){
    const d = new Date();
    return d.getFullYear() + '-' + pad(d.getMonth()+1) + '-' + pad(d.getDate()) + '_' + pad(d.getHours()) + '-' + pad(d.getMinutes());
  }
  function betterDownloadHTML(){
    try{
      if(typeof state!=='object' || !state){
        throw new Error('Estado no disponible');
      }
      var html = document.documentElement.outerHTML;
      var payload;
      try{
        payload = JSON.stringify(state).replace(/</g,'\\u003C');
      }catch(e){
        console.error('No se pudo serializar el estado', e);
        alert('No se pudo preparar los datos para compartir.');
        return;
      }
      var snapScript = '<script id="paSnapshot" type="application/json">'+payload+'<'+'/script>';
      var final;
      if(html.indexOf('<head>') !== -1){
        final = html.replace('<head>','<head>'+snapScript);
      }else if(html.indexOf('<body>') !== -1){
        final = html.replace('<body>','<body>'+snapScript);
      }else{
        final = snapScript + html;
      }
      var full = '';
      if(/^<!DOCTYPE html>/i.test(html.trim())){
        full = final;
      }else{
        full = '<!DOCTYPE html>\n' + final;
      }
      var blob = new Blob([full], {type:'text/html'});
      var a=document.createElement('a');
      a.href=URL.createObjectURL(blob);
      a.download='PROCESOS-AUDIO_' + fileStampOverride() + '.html';
      document.body.appendChild(a);
      a.click();
      setTimeout(function(){ URL.revokeObjectURL(a.href); a.remove(); }, 0);
    }catch(e){
      console.error(e);
      alert('No se pudo generar el HTML para compartir.');
    }
  }
    window.betterDownloadHTML = betterDownloadHTML;
window.addEventListener('load', function(){
    var btn = document.getElementById('paHtmlBtn');
    if(!btn) return;
    var clone = btn.cloneNode(true);
    clone.addEventListener('click', betterDownloadHTML);
    btn.parentNode.replaceChild(clone, btn);
  });
})();
</script>

</body></html>
